/*! For license information please see file-tus.js.LICENSE.txt */
(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5508,3111,501,8588,5636,8992,3577,7763],{5158:function(e){e.exports=function(e){if("number"!=typeof e||isNaN(e))throw new TypeError("Expected a number, got "+typeof e);const t=e<0,r=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(t&&(e=-e),e<1)return(t?"-":"")+e+" B";const i=Math.min(Math.floor(Math.log(e)/Math.log(1024)),r.length-1);e=Number(e/Math.pow(1024,i));const n=r[i];return e>=10||e%1==0?`${(t?"-":"")+e.toFixed(0)} ${n}`:`${(t?"-":"")+e.toFixed(1)} ${n}`}},7763:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return L}});var i=r(6400),n=r(396),s=r(6037),o=r(1653),a=r(7581),l=r(8215),u=r(6594),h={strings:{dropHereOr:"Drop here or %{browse}",browse:"browse"}},c="dragFileInput";function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(){g=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var s=t&&t.prototype instanceof d?t:d,o=Object.create(s.prototype),a=new E(n||[]);return i(o,"_invoke",{value:P(e,r,a)}),o}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var c={};function d(){}function f(){}function m(){}var y={};l(y,s,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(x([])));b&&b!==t&&r.call(b,s)&&(y=b);var w=m.prototype=d.prototype=Object.create(y);function O(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,s,o,a){var l=h(e[i],e,s);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==p(c)&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,o,a)}),(function(e){n("throw",e,o,a)})):t.resolve(c).then((function(e){u.value=e,o(u)}),(function(e){return n("throw",e,o,a)}))}a(l.arg)}var s;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return s=s?s.then(i,i):i()}})}function P(e,t,r){var i="suspendedStart";return function(n,s){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw s;return j()}for(r.method=n,r.arg=s;;){var o=r.delegate;if(o){var a=_(o,r);if(a){if(a===c)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var l=h(e,t,r);if("normal"===l.type){if(i=r.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i="completed",r.method="throw",r.arg=l.arg)}}}function _(e,t){var r=t.method,i=e.iterator[r];if(void 0===i)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),c;var n=h(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,c;var s=n.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function U(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function x(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:j}}function j(){return{value:void 0,done:!0}}return f.prototype=m,i(w,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:f,configurable:!0}),f.displayName=l(m,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,a,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},O(S.prototype),l(S.prototype,o,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,i,n,s){void 0===s&&(s=Promise);var o=new S(u(t,r,i,n),s);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},O(w),l(w,a,"Generator"),l(w,s,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=x,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(U),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return o.type="throw",o.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,c):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),U(r),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;U(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},e}function m(e,t,r,i,n,s,o){try{var a=e[s](o),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(i,n)}function y(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,P(i.key),i)}}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=O(e);if(t){var n=O(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}(this,r)}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},O(e)}function S(e,t,r){return(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==p(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===p(t)?t:String(t)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(o,e);var t,r,n,s=b(o);function o(e,t){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),S(w(r=s.call(this,e,t)),"handleDrop",function(){var e,t=(e=g().mark((function e(t){var i,n,s,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),t.stopPropagation(),clearTimeout(r.removeDragOverClassTimeout),r.setPluginState({isDraggingOver:!1}),s=function(e){r.uppy.log(e,"error")},e.next=7,(0,u.Z)(t.dataTransfer,{logDropError:s});case 7:(o=e.sent).length>0&&(r.uppy.log("[DragDrop] Files dropped"),r.addFiles(o)),null===(i=(n=r.opts).onDrop)||void 0===i||i.call(n,t);case 10:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(i,n){var s=e.apply(t,r);function o(e){m(s,i,n,o,a,"next",e)}function a(e){m(s,i,n,o,a,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}()),r.type="acquirer",r.id=r.opts.id||"DragDrop",r.title="Drag & Drop",r.defaultLocale=h;return r.opts=f(f({},{target:null,inputName:"files[]",width:"100%",height:"100%",note:null}),t),r.i18nInit(),r.isDragDropSupported=(0,l.Z)(),r.removeDragOverClassTimeout=null,r.onInputChange=r.onInputChange.bind(w(r)),r.handleDragOver=r.handleDragOver.bind(w(r)),r.handleDragLeave=r.handleDragLeave.bind(w(r)),r.handleDrop=r.handleDrop.bind(w(r)),r.addFiles=r.addFiles.bind(w(r)),r.render=r.render.bind(w(r)),r}return t=o,r=[{key:"addFiles",value:function(e){var t=this,r=e.map((function(e){return{source:t.id,name:e.name,type:e.type,data:e,meta:{relativePath:e.relativePath||null}}}));try{this.uppy.addFiles(r)}catch(e){this.uppy.log(e)}}},{key:"onInputChange",value:function(e){var t=(0,a.Z)(e.target.files);t.length>0&&(this.uppy.log("[DragDrop] Files selected through input"),this.addFiles(t)),e.target.value=null}},{key:"handleDragOver",value:function(e){var t,r;e.preventDefault(),e.stopPropagation();var i=e.dataTransfer.types.some((function(e){return"Files"===e})),n=this.uppy.getState().allowNewUpload;if(!i||!n)return e.dataTransfer.dropEffect="none",void clearTimeout(this.removeDragOverClassTimeout);e.dataTransfer.dropEffect="copy",clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!0}),null===(t=(r=this.opts).onDragOver)||void 0===t||t.call(r,e)}},{key:"handleDragLeave",value:function(e){var t,r,i=this;e.preventDefault(),e.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.removeDragOverClassTimeout=setTimeout((function(){i.setPluginState({isDraggingOver:!1})}),50),null===(t=(r=this.opts).onDragLeave)||void 0===t||t.call(r,e)}},{key:"renderHiddenFileInput",value:function(){var e=this,t=this.uppy.opts.restrictions;return(0,i.h)("input",{className:"wcpauppy-DragDrop-input",type:"file",hidden:!0,ref:function(t){e.fileInputRef=t},name:this.opts.inputName,multiple:1!==t.maxNumberOfFiles,accept:t.allowedFileTypes,onChange:this.onInputChange})}},{key:"renderLabel",value:function(){return(0,i.h)("div",{className:"wcpauppy-DragDrop-label"},this.i18nArray("dropHereOr",{browse:(0,i.h)("span",{className:"wcpauppy-DragDrop-browse"},this.i18n("browse"))}))}},{key:"renderNote",value:function(){return(0,i.h)("span",{className:"wcpauppy-DragDrop-note"},this.opts.note)}},{key:"render",value:function(){var e=this,t="wcpauppy-u-reset\n      wcpauppy-DragDrop-container\n      ".concat(this.isDragDropSupported?"wcpauppy-DragDrop--isDragDropSupported":"","\n      ").concat(this.getPluginState().isDraggingOver?"wcpauppy-DragDrop--isDraggingOver":"","\n    "),r={width:this.opts.width,height:this.opts.height};return(0,i.h)("div",{className:c},(0,i.h)("button",{type:"button",className:t,style:r,onClick:function(){return e.fileInputRef.click()},onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},this.renderHiddenFileInput(),(0,i.h)("div",{className:"wcpauppy-DragDrop-inner"},(0,i.h)("div",{className:"wcpauppy-DragDrop-icon"},o.renderArrowSvg()),(0,i.h)("p",null,this.opts.placeholder),(0,i.h)("span",{dangerouslySetInnerHTML:{__html:window.wcpa_front.strings.file_droppable_desc_text.replace("{action}","<i>".concat(window.wcpa_front.strings.file_droppable_action_text,"</i>"))}}))))}},{key:"install",value:function(){var e=this.opts.target;this.setPluginState({isDraggingOver:!1}),e&&this.mount(e,this)}},{key:"uninstall",value:function(){this.unmount()}}],n=[{key:"renderArrowSvg",value:function(){return(0,i.h)("svg",{width:"50",height:"38",viewBox:"0 0 50 38",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,i.h)("path",{d:"M0.618408 36.4785C0.402719 36.1777 0.275391 35.8089 0.275391 35.4105V31.5264V6.69029C0.275391 5.80942 0.989416 5.09484 1.87083 5.09484H3.07551C4.28952 5.09484 5.27357 4.11079 5.27357 2.89679C5.27357 1.68278 6.25762 0.69873 7.47162 0.69873H19.9739C20.7939 0.69873 21.5458 1.15481 21.9239 1.88255L22.9799 3.91212C23.3585 4.63932 24.1099 5.09594 24.9298 5.09594H39.4046C40.2855 5.09594 41.0001 5.80997 41.0001 6.69138V15.8261L0.618408 36.4785Z",fill:"#A6CFFF"}),(0,i.h)("path",{d:"M9.29776 17.1251C9.6523 16.3343 10.4388 15.825 11.3054 15.825H47.9473C49.1954 15.825 50.0285 17.1114 49.5181 18.2502L41.7083 35.6673C41.278 36.6272 40.3241 37.2452 39.272 37.2452H5.99546H2.1114C1.49617 37.2452 0.952279 36.9428 0.619141 36.4785L0.620787 36.4774L5.07837 26.5353L9.29776 17.1251Z",fill:"#488DF4"}))}}],r&&y(t.prototype,r),n&&y(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(s.di);S(_,"VERSION","3.0.1");var k=r(9529),U=r(7049),E=r(7894),x=r(8697);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,s,o,a=[],l=!0,u=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=s.call(r)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){u=!0,n=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw n}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==j(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===j(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var D={};var I=function(e){var t=e.file.preview,r="";if(t)r=t;else{r="".concat(window.wcpa_front.assets_url,"images/front/").concat("default-image.svg")}return(0,i.h)("div",{class:"wcpa_thumb"},(0,i.h)("img",{src:r}))},L=function(e){var t=e.field,r=e.design,a=e.handleChange,l=e.fieldData,u=e.product,h=e.handleToolTip,c=e._labelPosition,p=e._descPosition,d=e.isDisabled,f=e.enableQuantity,g=e.onQuantityChange,m=e.formsCount,y=e.method,v=t.required,b=t.placeholder,w=t.name,O=t.multiple_upload,S=t.uploadSize,P=t.min_file_count,j=t.minUploadSize,F=t.allowedFileTypes,R=t.elementId,C=t.max_file_count,L=t.upload_type,N=t.quantity_label,q=t.min_quantity,$=t.max_quantity,z=u.product_id,M=q||1,B=(0,E.Tj)(R,m),H=(0,n.sO)(),V=(0,n.sO)(),K=(0,n.sO)([]),X=(0,n.sO)([]),G=(0,n.sO)(0),W=T((0,n.eJ)((new Date).getMilliseconds()),2),Z=W[0],Y=W[1],J=T((0,n.eJ)(""),2),Q=J[0],ee=J[1],te=T((0,n.eJ)(!1),2),re=te[0],ie=te[1],ne=T((0,n.eJ)(b),2),se=ne[0],oe=ne[1],ae=T((0,n.eJ)(!1),2),le=ae[0],ue=ae[1],he=1;O&&(he=t.max_file_count?t.max_file_count:10);var ce,pe,de=""!==F.trim()?F.split(","):void 0;void 0===H.current&&(H.current=(ce="uppy_".concat(z.parent,"_").concat(R),pe={maxNumberOfFiles:he,allowedFileTypes:de,maxFileSize:!!S&&1024*S*1024,minFileSize:!!j&&1024*j*1024},D[ce]||(D[ce]=new s.ZP({id:ce,debug:!0,autoProceed:!0,locale:{strings:{youCanOnlyUploadX:{0:"max_file_count",1:"max_file_count"},youHaveToAtLeastSelectX:{0:"min_file_count",1:"min_file_count"},exceedsSize:"uploadSize",inferiorSize:"minUploadSize",youCanOnlyUploadFileTypes:"allowedFileTypes",noDuplicates:"noDuplicates",dropHereOr:window.wcpa_front.strings.file_droppable_desc_text,browse:window.wcpa_front.strings.file_droppable_action_text}},restrictions:A({maxNumberOfFiles:1},pe)})),D[ce])),(0,n.d4)((function(){var e={},r=[],i=X.current.map((function(e){return e.uploadStatus&&!0===e.uploadStatus.status&&r.push(e.uploadStatus.file),{name:e.name,extension:e.extension,size:e.size,type:e.type,uploadStatus:e.uploadStatus||!1}}));0==i.length?oe(b):1==i.length?oe(i[0].name):oe(window.wcpa_front.strings.file_placeholder.replace("{count}",i.length)),ee(JSON.stringify(r)),i.length&&!re&&ie(!0);var n=H.current.getState().info;v&&re&&0==i.length?e.required={show:!0,message:(0,E.N3)("requiredError",t),isBlocking:!0,newValue:!1}:O&&i.length>=1&&i.length<parseInt(P)?e.min_file_count={show:!0,message:(0,E.N3)("minFileCountError",t).replace("%s",P),isBlocking:!0,newValue:!1}:n.some((function(r){return"Upload error"==r.details?(e.uploadError={show:!0,message:(0,E.N3)("uploadError",t).replace("%s",i[0].name),isBlocking:!1,newValue:!1},!0):(delete e.uploadError,"max_file_count"==r.message?(e.max_file_count={show:!0,message:(0,E.N3)("maxFileCountError",t).replace("%s",O?void 0===C?O?10:1:C:1),isBlocking:!1,newValue:!1},!0):(delete e.max_file_count,"uploadSize"==r.message?(e.uploadSize={show:!0,message:(0,E.N3)("maxFileSizeError",t).replace("%s",S+"MB"),isBlocking:!1,newValue:!1},!0):(delete e.uploadSize,"minUploadSize"==r.message?(e.minUploadSize={show:!0,message:(0,E.N3)("minFileSizeError",t).replace("%s",j+"MB"),isBlocking:!1,newValue:!1},!0):(delete e.minUploadSize,"allowedFileTypes"==r.message?(e.allowedFileTypes={show:!0,message:(0,E.N3)("fileExtensionError",t),isBlocking:!1,newValue:!1},!0):(delete e.allowedFileTypes,"noDuplicates"==r.message?(e.allowedFileTypes={show:!0,message:(0,E.N3)("noDuplicates",t),isBlocking:!1,newValue:!1},!0):(delete e.noDuplicates,void(e.other={show:!0,message:r.message,isBlocking:!1,newValue:!1})))))))})),a(R,i,e)}),[Z]);var fe=function(e){H.current.removeFile(e.target.id)};(0,n.d4)((function(){if("droppable"==L&&H.current.use(_,{target:K.current,width:"100%",height:"100%",note:null,placeholder:b||window.wcpa_front.strings.file_droppable_text}),"tus"==y)H.current.use(e.Tus,{endpoint:"".concat(window.wcpa_front.root,"tus_upload/").concat(z.parent,"/").concat(w,"/"),resume:!0,uploadDataDuringCreation:!1,parallelUploads:1,allowedMetaFields:["name","size","type"],headers:null!==window.wcpa_front.api_nonce?{"X-WP-Nonce":window.wcpa_front.api_nonce}:void 0});else if("s3"==y)H.current.use(e.AwsS3,{getUploadParameters:function(e){return fetch("".concat(window.wcpa_front.root,"s3-sign/").concat(z.parent,"/").concat(w,"/"),{method:"post",headers:{accept:"application/json","content-type":"application/json"},body:JSON.stringify({filename:e.name,contentType:e.type,size:e.size})}).then((function(e){return e.json()})).then((function(t){return{method:t.method,url:t.url,fields:t.fields,headers:{"Content-Type":e.type}}}))}});else{H.current.getFiles().forEach((function(e){H.current.removeFile(e.id)})),H.current.use(o.Z,{endpoint:"".concat(window.wcpa_front.root,"upload/").concat(z.parent,"/").concat(w,"/"),formData:!0,bundle:!1,fieldName:"wcpa_file",headers:null!==window.wcpa_front.api_nonce?{"X-WP-Nonce":window.wcpa_front.api_nonce}:void 0})}if(V.current){var r,i=null===(r=V.current.parentElement)||void 0===r?void 0:r.offsetWidth;i>0&&ue(i)}return H.current.use(U.Z,{thumbnailWidth:75}),H.current.on("file-added",(function(e){e.meta=A(A({},e.meta),{},{size:e.size}),X.current.push(e),Y((new Date).getMilliseconds())})),H.current.on("file-removed",(function(e,t){var r=X.current.findIndex((function(t){return t.id===e.id}));-1!==r&&X.current.splice(r,1),0==X.current.length&&V.current&&(V.current.value=""),Y((new Date).getMilliseconds())})),H.current.on("info-visible",(function(){Y((new Date).getMilliseconds())})),H.current.on("thumbnail:generated",(function(e,t){var r=X.current.filter((function(t){return t.id===e.id}));r&&(r[0].preview=t),Y((new Date).getMilliseconds())})),H.current.on("progress",(function(e){G.current=Math.min(85,e),Y((new Date).getMilliseconds())})),H.current.on("complete",(function(e){G.current=100,Y((new Date).getMilliseconds())})),H.current.on("upload-progress",(function(e,t){var r=X.current.filter((function(t){return t.id===e.id}));r&&(r[0].progress.percentage=Math.min(85,Math.round(100*t.bytesUploaded/t.bytesTotal))),Y((new Date).getMilliseconds())})),H.current.on("upload-error",(function(e,t,r){var i=X.current.filter((function(t){return t.id===e.id}));i&&(i[0].uploadStatus=r.body),Y((new Date).getMilliseconds())})),H.current.on("upload-success",(function(e,t){var r=X.current.filter((function(t){return t.id===e.id}));r&&(r[0].uploadStatus="tus"==y||"s3"==y?{status:!0,file:{file:t.uploadURL,file_name:r[0].name,type:r[0].type}}:t.body,r[0].progress.percentage=100),Y((new Date).getMilliseconds())})),(void 0!==ge||0==ge&&t.preSetValue)&&(0,E.kJ)(t.preSetValue)&&t.preSetValue.forEach((function(e){fetch(e.url).then((function(e){return e.blob()})).then((function(t){H.current.addFile({name:e.name,type:e.type,data:t})}))})),function(){var e;null===(e=H.current)||void 0===e||e.close({reason:"unmount"}),H.current=void 0}}),[H]);var ge=l.value,me=l.quantity,ye=!1;void 0!==ge&&((0,E.kJ)(ge)?ge.length>0:""!=ge)&&(ye=!0);var ve=(0,i.h)("div",{className:"wcpa_field"},"droppable"==L&&(0,i.h)("div",{ref:K},(0,i.h)("div",{style:{width:G.current+"%"}})),"ajax"==L&&(0,i.h)("label",{className:"wcpa_file_style"},(0,i.h)("input",{ref:V,type:"file",multiple:O,accept:F,onChange:function(e){Array.from(e.target.files).forEach((function(e){try{H.current.addFile({source:"file input",name:e.name,type:e.type,data:e})}catch(e){e.isRestriction}}))},disabled:d,placeholder:b,value:window.wcpa_front.strings.file_button_text,id:B}),(0,i.h)("div",{className:"awpca_custom_file"},(0,i.h)("p",null,se||" "),"  ",(0,i.h)("span",{className:"wcpa_choose_button"},window.wcpa_front.strings.file_button_text))),(0,i.h)("input",{type:"hidden",name:"".concat((0,E.uM)(w)),value:Q}));return(0,i.h)(i.HY,null,(0,i.h)(k.Z,{handleToolTip:h,_labelPosition:c,_descPosition:p,field:t,dField:l,targetId:B},(0,i.h)("div",{style:le?{maxWidth:le+"px"}:{}},f?(0,i.h)("div",{className:"wcpa_quantity_wrap"},ve,N?(0,i.h)("div",{className:"wcpa_label_wrap"},(0,i.h)("label",null," ",N),(0,i.h)(x.Z,{name:"".concat((0,E.uM)(w,"_quantity")),disabled:d||!ye,defaultValue:me,min:M,max:$,onChange:function(e){g(t,e.target.value)},design:r})):(0,i.h)(x.Z,{name:"".concat((0,E.uM)(w,"_quantity")),disabled:d||!ye,defaultValue:me,min:M,max:$,onChange:function(e){g(t,e.target.value)},design:r})):ve,(0,i.h)("ul",{className:"wcpa_file_list"},X.current.map((function(e){return(0,i.h)("li",{key:e.id},(0,i.h)("div",{className:"wcpa_file_details"},(0,i.h)(I,{file:e}),(0,i.h)("p",null,(0,i.h)("span",null,null==e?void 0:e.name),(t=(null==e?void 0:e.size)||0,r=1024,n=Math.floor(Math.log(t)/Math.log(r)),+(t/r/r).toFixed(2)+["bytes","kb","mb","gb","tb","pb","eb","zb","yb"][n]))),(0,i.h)("div",{className:"wcpa_progressbar_area ".concat(0==e.progress.percentage?"wcpa_progress_wait":"")},e.uploadStatus&&0==e.uploadStatus.status?"":(0,i.h)("div",{className:"wcpa_progressbar"},(0,i.h)("span",{style:{width:e.progress.percentage+"%"},className:e.uploadStatus&&1==e.uploadStatus.status&&"wcpa_success"})),(0,i.h)("p",{className:"wcpa_status"},e.uploadStatus&&(0,i.h)(i.HY,null,1==e.uploadStatus.status&&(0,i.h)("div",{className:"awpca_complete"},window.wcpa_front.strings.file_upload_completed),0==e.uploadStatus.status&&(0,i.h)("div",{className:"awpca_failed"},window.wcpa_front.strings.file_upload_failed))||e.progress.percentage+"%")),(0,i.h)("span",{id:e.id,className:"wcpa_remove_file",onClick:fe}));var t,r,n}))))))}},7647:function(e,t,r){"use strict";r.r(t);var i=r(6400),n=r(3577),s=r(7763);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},o.apply(this,arguments)}t.default=function(e){return(0,i.h)(s.default,o({},e,{method:"tus",Tus:n.Z}))}},3096:function(e,t,r){var i="Expected a function",n=NaN,s="[object Symbol]",o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,u=/^0o[0-7]+$/i,h=parseInt,c="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,p="object"==typeof self&&self&&self.Object===Object&&self,d=c||p||Function("return this")(),f=Object.prototype.toString,g=Math.max,m=Math.min,y=function(){return d.Date.now()};function v(e,t,r){var n,s,o,a,l,u,h=0,c=!1,p=!1,d=!0;if("function"!=typeof e)throw new TypeError(i);function f(t){var r=n,i=s;return n=s=void 0,h=t,a=e.apply(i,r)}function v(e){var r=e-u;return void 0===u||r>=t||r<0||p&&e-h>=o}function O(){var e=y();if(v(e))return S(e);l=setTimeout(O,function(e){var r=t-(e-u);return p?m(r,o-(e-h)):r}(e))}function S(e){return l=void 0,d&&n?f(e):(n=s=void 0,a)}function P(){var e=y(),r=v(e);if(n=arguments,s=this,u=e,r){if(void 0===l)return function(e){return h=e,l=setTimeout(O,t),c?f(e):a}(u);if(p)return l=setTimeout(O,t),f(u)}return void 0===l&&(l=setTimeout(O,t)),a}return t=w(t)||0,b(r)&&(c=!!r.leading,o=(p="maxWait"in r)?g(w(r.maxWait)||0,t):o,d="trailing"in r?!!r.trailing:d),P.cancel=function(){void 0!==l&&clearTimeout(l),h=0,n=u=s=l=void 0},P.flush=function(){return void 0===l?a:S(y())},P}function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function w(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&f.call(e)==s}(e))return n;if(b(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=b(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var r=l.test(e);return r||u.test(e)?h(e.slice(2),r?2:8):a.test(e)?n:+e}e.exports=function(e,t,r){var n=!0,s=!0;if("function"!=typeof e)throw new TypeError(i);return b(r)&&(n="leading"in r?!!r.leading:n,s="trailing"in r?!!r.trailing:s),v(e,t,{leading:n,maxWait:t,trailing:s})}},2705:function(e,t,r){var i=r(5639).Symbol;e.exports=i},4239:function(e,t,r){var i=r(2705),n=r(9607),s=r(2333),o=i?i.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?n(e):s(e)}},7561:function(e,t,r){var i=r(7990),n=/^\s+/;e.exports=function(e){return e?e.slice(0,i(e)+1).replace(n,""):e}},1957:function(e,t,r){var i="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=i},9607:function(e,t,r){var i=r(2705),n=Object.prototype,s=n.hasOwnProperty,o=n.toString,a=i?i.toStringTag:void 0;e.exports=function(e){var t=s.call(e,a),r=e[a];try{e[a]=void 0;var i=!0}catch(e){}var n=o.call(e);return i&&(t?e[a]=r:delete e[a]),n}},2333:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5639:function(e,t,r){var i=r(1957),n="object"==typeof self&&self&&self.Object===Object&&self,s=i||n||Function("return this")();e.exports=s},7990:function(e){var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},3279:function(e,t,r){var i=r(3218),n=r(7771),s=r(4841),o=Math.max,a=Math.min;e.exports=function(e,t,r){var l,u,h,c,p,d,f=0,g=!1,m=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var r=l,i=u;return l=u=void 0,f=t,c=e.apply(i,r)}function b(e){var r=e-d;return void 0===d||r>=t||r<0||m&&e-f>=h}function w(){var e=n();if(b(e))return O(e);p=setTimeout(w,function(e){var r=t-(e-d);return m?a(r,h-(e-f)):r}(e))}function O(e){return p=void 0,y&&l?v(e):(l=u=void 0,c)}function S(){var e=n(),r=b(e);if(l=arguments,u=this,d=e,r){if(void 0===p)return function(e){return f=e,p=setTimeout(w,t),g?v(e):c}(d);if(m)return clearTimeout(p),p=setTimeout(w,t),v(d)}return void 0===p&&(p=setTimeout(w,t)),c}return t=s(t)||0,i(r)&&(g=!!r.leading,h=(m="maxWait"in r)?o(s(r.maxWait)||0,t):h,y="trailing"in r?!!r.trailing:y),S.cancel=function(){void 0!==p&&clearTimeout(p),f=0,l=d=u=p=void 0},S.flush=function(){return void 0===p?c:O(n())},S}},3218:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},7005:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},3448:function(e,t,r){var i=r(4239),n=r(7005);e.exports=function(e){return"symbol"==typeof e||n(e)&&"[object Symbol]"==i(e)}},7771:function(e,t,r){var i=r(5639);e.exports=function(){return i.Date.now()}},3493:function(e,t,r){var i=r(3279),n=r(3218);e.exports=function(e,t,r){var s=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return n(r)&&(s="leading"in r?!!r.leading:s,o="trailing"in r?!!r.trailing:o),i(e,t,{leading:s,maxWait:t,trailing:o})}},4841:function(e,t,r){var i=r(7561),n=r(3218),s=r(3448),o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(s(e))return NaN;if(n(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=n(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var r=a.test(e);return r||l.test(e)?u(e.slice(2),r?2:8):o.test(e)?NaN:+e}},4193:function(e,t,r){var i=r(1196),n=/[\/\+\.]/;e.exports=function(e,t){function r(t){var r=i(t,e,n);return r&&r.length>=2}return t?r(t.split(";")[0]):r}},4800:function(e){e.exports=function(){var e={},t=e._fns={};return e.emit=function(e,r,i,n,s,o,a){var l=function(e){var r=t[e]?t[e]:[],i=e.indexOf(":"),n=-1===i?[e]:[e.substring(0,i),e.substring(i+1)],s=Object.keys(t),o=0,a=s.length;for(;o<a;o++){var l=s[o];if("*"===l&&(r=r.concat(t[l])),2===n.length&&n[0]===l){r=r.concat(t[l]);break}}return r}(e);l.length&&function(e,t,r){var i=0,n=t.length;for(;i<n&&t[i];i++)t[i].event=e,t[i].apply(t[i],r)}(e,l,[r,i,n,s,o,a])},e.on=function(e,r){t[e]||(t[e]=[]),t[e].push(r)},e.once=function(t,r){this.on(t,(function i(){r.apply(this,arguments),e.off(t,i)}))},e.off=function(e,t){var r=[];if(e&&t)for(var i=this._fns[e],n=0,s=i?i.length:0;n<s;n++)i[n]!==t&&r.push(i[n]);r.length?this._fns[e]=r:delete this._fns[e]},e}},3398:function(e,t){"use strict";var r=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function n(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var i,s,o=[];for(s in"string"!=typeof t&&(t="?"),e)if(r.call(e,s)){if((i=e[s])||null!=i&&!isNaN(i)||(i=""),s=n(s),i=n(i),null===s||null===i)continue;o.push(s+"="+i)}return o.length?t+o.join("&"):""},t.parse=function(e){for(var t,r=/([^=?#&]+)=?([^&]*)/g,n={};t=r.exec(e);){var s=i(t[1]),o=i(t[2]);null===s||null===o||s in n||(n[s]=o)}return n}},7418:function(e){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},4564:function(e,t,r){"use strict";var i=r(7418),n=r(3398),s=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,o=/[\n\r\t]/g,a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,l=/:\d+$/,u=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,h=/^[a-zA-Z]:/;function c(e){return(e||"").toString().replace(s,"")}var p=[["#","hash"],["?","query"],function(e,t){return g(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],d={hash:1,query:1};function f(e){var t,i=("undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{}).location||{},n={},s=typeof(e=e||i);if("blob:"===e.protocol)n=new y(unescape(e.pathname),{});else if("string"===s)for(t in n=new y(e,{}),d)delete n[t];else if("object"===s){for(t in e)t in d||(n[t]=e[t]);void 0===n.slashes&&(n.slashes=a.test(e.href))}return n}function g(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function m(e,t){e=(e=c(e)).replace(o,""),t=t||{};var r,i=u.exec(e),n=i[1]?i[1].toLowerCase():"",s=!!i[2],a=!!i[3],l=0;return s?a?(r=i[2]+i[3]+i[4],l=i[2].length+i[3].length):(r=i[2]+i[4],l=i[2].length):a?(r=i[3]+i[4],l=i[3].length):r=i[4],"file:"===n?l>=2&&(r=r.slice(2)):g(n)?r=i[4]:n?s&&(r=r.slice(2)):l>=2&&g(t.protocol)&&(r=i[4]),{protocol:n,slashes:s||g(n),slashesCount:l,rest:r}}function y(e,t,r){if(e=(e=c(e)).replace(o,""),!(this instanceof y))return new y(e,t,r);var s,a,l,u,d,v,b=p.slice(),w=typeof t,O=this,S=0;for("object"!==w&&"string"!==w&&(r=t,t=null),r&&"function"!=typeof r&&(r=n.parse),s=!(a=m(e||"",t=f(t))).protocol&&!a.slashes,O.slashes=a.slashes||s&&t.slashes,O.protocol=a.protocol||t.protocol||"",e=a.rest,("file:"===a.protocol&&(2!==a.slashesCount||h.test(e))||!a.slashes&&(a.protocol||a.slashesCount<2||!g(O.protocol)))&&(b[3]=[/(.*)/,"pathname"]);S<b.length;S++)"function"!=typeof(u=b[S])?(l=u[0],v=u[1],l!=l?O[v]=e:"string"==typeof l?~(d="@"===l?e.lastIndexOf(l):e.indexOf(l))&&("number"==typeof u[2]?(O[v]=e.slice(0,d),e=e.slice(d+u[2])):(O[v]=e.slice(d),e=e.slice(0,d))):(d=l.exec(e))&&(O[v]=d[1],e=e.slice(0,d.index)),O[v]=O[v]||s&&u[3]&&t[v]||"",u[4]&&(O[v]=O[v].toLowerCase())):e=u(e,O);r&&(O.query=r(O.query)),s&&t.slashes&&"/"!==O.pathname.charAt(0)&&(""!==O.pathname||""!==t.pathname)&&(O.pathname=function(e,t){if(""===e)return t;for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),i=r.length,n=r[i-1],s=!1,o=0;i--;)"."===r[i]?r.splice(i,1):".."===r[i]?(r.splice(i,1),o++):o&&(0===i&&(s=!0),r.splice(i,1),o--);return s&&r.unshift(""),"."!==n&&".."!==n||r.push(""),r.join("/")}(O.pathname,t.pathname)),"/"!==O.pathname.charAt(0)&&g(O.protocol)&&(O.pathname="/"+O.pathname),i(O.port,O.protocol)||(O.host=O.hostname,O.port=""),O.username=O.password="",O.auth&&(~(d=O.auth.indexOf(":"))?(O.username=O.auth.slice(0,d),O.username=encodeURIComponent(decodeURIComponent(O.username)),O.password=O.auth.slice(d+1),O.password=encodeURIComponent(decodeURIComponent(O.password))):O.username=encodeURIComponent(decodeURIComponent(O.auth)),O.auth=O.password?O.username+":"+O.password:O.username),O.origin="file:"!==O.protocol&&g(O.protocol)&&O.host?O.protocol+"//"+O.host:"null",O.href=O.toString()}y.prototype={set:function(e,t,r){var s=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(r||n.parse)(t)),s[e]=t;break;case"port":s[e]=t,i(t,s.protocol)?t&&(s.host=s.hostname+":"+t):(s.host=s.hostname,s[e]="");break;case"hostname":s[e]=t,s.port&&(t+=":"+s.port),s.host=t;break;case"host":s[e]=t,l.test(t)?(t=t.split(":"),s.port=t.pop(),s.hostname=t.join(":")):(s.hostname=t,s.port="");break;case"protocol":s.protocol=t.toLowerCase(),s.slashes=!r;break;case"pathname":case"hash":if(t){var o="pathname"===e?"/":"#";s[e]=t.charAt(0)!==o?o+t:t}else s[e]=t;break;case"username":case"password":s[e]=encodeURIComponent(t);break;case"auth":var a=t.indexOf(":");~a?(s.username=t.slice(0,a),s.username=encodeURIComponent(decodeURIComponent(s.username)),s.password=t.slice(a+1),s.password=encodeURIComponent(decodeURIComponent(s.password))):s.username=encodeURIComponent(decodeURIComponent(t))}for(var u=0;u<p.length;u++){var h=p[u];h[4]&&(s[h[1]]=s[h[1]].toLowerCase())}return s.auth=s.password?s.username+":"+s.password:s.username,s.origin="file:"!==s.protocol&&g(s.protocol)&&s.host?s.protocol+"//"+s.host:"null",s.href=s.toString(),s},toString:function(e){e&&"function"==typeof e||(e=n.stringify);var t,r=this,i=r.host,s=r.protocol;s&&":"!==s.charAt(s.length-1)&&(s+=":");var o=s+(r.protocol&&r.slashes||g(r.protocol)?"//":"");return r.username?(o+=r.username,r.password&&(o+=":"+r.password),o+="@"):r.password?(o+=":"+r.password,o+="@"):"file:"!==r.protocol&&g(r.protocol)&&!i&&"/"!==r.pathname&&(o+="@"),(":"===i[i.length-1]||l.test(r.hostname)&&!r.port)&&(i+=":"),o+=i+r.pathname,(t="object"==typeof r.query?e(r.query):r.query)&&(o+="?"!==t.charAt(0)?"?"+t:t),r.hash&&(o+=r.hash),o}},y.extractProtocol=m,y.location=f,y.trimLeft=c,y.qs=n,e.exports=y},1196:function(e){"use strict";function t(e,t){this.text=e=e||"",this.hasWild=~e.indexOf("*"),this.separator=t,this.parts=e.split(t)}t.prototype.match=function(e){var t,r,i=!0,n=this.parts,s=n.length;if("string"==typeof e||e instanceof String)if(this.hasWild||this.text==e){for(r=(e||"").split(this.separator),t=0;i&&t<s;t++)"*"!==n[t]&&(i=t<r.length&&n[t]===r[t]);i=i&&r}else i=!1;else if("function"==typeof e.splice)for(i=[],t=e.length;t--;)this.match(e[t])&&(i[i.length]=e[t]);else if("object"==typeof e)for(var o in i={},e)this.match(o)&&(i[o]=e[o]);return i},e.exports=function(e,r,i){var n=new t(e,i||/[\/\.]/);return void 0!==r?n.match(r):n}},9537:function(e,t,r){"use strict";r.d(t,{zt:function(){return x},C$:function(){return y},sk:function(){return M}});var i={};r.r(i),r.d(i,{getItem:function(){return w},removeItem:function(){return O},setItem:function(){return b}});class n extends Error{constructor(e,t){void 0===t&&(t=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}var s=n;class o extends Error{constructor(e,t){var r,i;void 0===t&&(t={}),super(e),this.cause=t.cause,this.cause&&(r=this.cause,i="isNetworkError",Object.prototype.hasOwnProperty.call(r,i))&&(this.isNetworkError=this.cause.isNetworkError)}}var a=o;class l extends Error{constructor(){super("Authorization required"),this.name="AuthError",this.isAuthError=!0}}var u=l;let h;function c(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var p=0;function d(e){return"__private_"+p+++"_"+e}const f=new Map;var g=d("companionHeaders"),m=d("getUrl");h=Symbol.for("uppy test: getCompanionHeaders");class y{constructor(e,t){Object.defineProperty(this,m,{value:v}),Object.defineProperty(this,g,{writable:!0,value:void 0}),this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),c(this,g)[g]=null==t?void 0:t.companionHeaders}setCompanionHeaders(e){c(this,g)[g]=e}[h](){return c(this,g)[g]}get hostname(){const{companion:e}=this.uppy.getState(),t=this.opts.companionUrl;return(e&&e[t]?e[t]:t).replace(/\/$/,"")}async headers(){return{...{Accept:"application/json","Content-Type":"application/json","Uppy-Versions":`@uppy/companion-client=${y.VERSION}`},...c(this,g)[g]}}onReceiveResponse(e){let{headers:t}=e;const r=this.uppy.getState().companion||{},i=this.opts.companionUrl;t.has("i-am")&&t.get("i-am")!==r[i]&&this.uppy.setState({companion:{...r,[i]:t.get("i-am")}})}async preflight(e){const t=f.get(this.hostname);if(null!=t)return t;const r=["accept","content-type","uppy-auth-token"],i=(async()=>{try{const t=(await fetch(c(this,m)[m](e),{method:"OPTIONS"})).headers.get("access-control-allow-headers");if(null==t||"*"===t)return f.set(this.hostname,r),r;this.uppy.log(`[CompanionClient] adding allowed preflight headers to companion cache: ${this.hostname} ${t}`);const i=t.split(",").map((e=>e.trim().toLowerCase()));return f.set(this.hostname,i),i}catch(e){return this.uppy.log(`[CompanionClient] unable to make preflight request ${e}`,"warning"),f.delete(this.hostname),r}})();return f.set(this.hostname,i),i}async preflightAndHeaders(e){const[t,r]=await Promise.all([this.preflight(e),this.headers()]);return Object.fromEntries(Object.entries(r).filter((e=>{let[r]=e;return!!t.includes(r.toLowerCase())||(this.uppy.log(`[CompanionClient] excluding disallowed header ${r}`),!1)})))}async request(e){let{path:t,method:r="GET",data:i,skipPostResponse:n,signal:o}=e;try{const e=await this.preflightAndHeaders(t),a=await function(){return fetch(...arguments).catch((e=>{throw"AbortError"===e.name?e:new s(e)}))}(c(this,m)[m](t),{method:r,signal:o,headers:e,credentials:this.opts.companionCookiesRule||"same-origin",body:i?JSON.stringify(i):null});return n||this.onReceiveResponse(a),async function(e){if(401===e.status)throw new u;const t=e.json();if(e.ok)return t;let r=`Failed request with status: ${e.status}. ${e.statusText}`;try{const e=await t;r=e.message?`${r} message: ${e.message}`:r,r=e.requestId?`${r} request-Id: ${e.requestId}`:r}catch{}throw new Error(r)}(a)}catch(e){if(null!=e&&e.isAuthError)throw e;throw new a(`Could not ${r} ${c(this,m)[m](t)}`,{cause:e})}}async get(e,t){return void 0===t&&(t=void 0),"boolean"==typeof t&&(t={skipPostResponse:t}),this.request({...t,path:e})}async post(e,t,r){return void 0===r&&(r=void 0),"boolean"==typeof r&&(r={skipPostResponse:r}),this.request({...r,path:e,method:"POST",data:t})}async delete(e,t,r){return void 0===t&&(t=void 0),"boolean"==typeof r&&(r={skipPostResponse:r}),this.request({...r,path:e,method:"DELETE",data:t})}}function v(e){return/^(https?:|)\/\//.test(e)?e:`${this.hostname}/${e}`}function b(e,t){return new Promise((r=>{localStorage.setItem(e,t),r()}))}function w(e){return Promise.resolve(localStorage.getItem(e))}function O(e){return new Promise((t=>{localStorage.removeItem(e),t()}))}function S(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}y.VERSION="3.2.1";var P=0;function _(e){return"__private_"+P+++"_"+e}var k=_("refreshingTokenPromise"),U=_("getAuthToken"),E=_("removeAuthToken");class x extends y{constructor(e,t){super(e,t),Object.defineProperty(this,E,{value:T}),Object.defineProperty(this,U,{value:j}),Object.defineProperty(this,k,{writable:!0,value:void 0}),this.provider=t.provider,this.id=this.provider,this.name=this.opts.name||(e=>e.split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "))(this.id),this.pluginId=this.opts.pluginId,this.tokenKey=`companion-${this.pluginId}-auth-token`,this.companionKeysParams=this.opts.companionKeysParams,this.preAuthToken=null}async headers(){const[e,t]=await Promise.all([super.headers(),S(this,U)[U]()]),r={};return t&&(r["uppy-auth-token"]=t),this.companionKeysParams&&(r["uppy-credentials-params"]=btoa(JSON.stringify({params:this.companionKeysParams}))),{...e,...r}}onReceiveResponse(e){super.onReceiveResponse(e);const t=this.uppy.getPlugin(this.pluginId),r=t.getPluginState().authenticated?401!==e.status:e.status<400;return t.setPluginState({authenticated:r}),e}async setAuthToken(e){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,e)}async ensurePreAuth(){if(this.companionKeysParams&&!this.preAuthToken&&(await this.fetchPreAuthToken(),!this.preAuthToken))throw new Error("Could not load authentication data required for third-party login. Please try again later.")}authUrl(e){void 0===e&&(e={});const t=new URLSearchParams(e);return this.preAuthToken&&t.set("uppyPreAuthToken",this.preAuthToken),`${this.hostname}/${this.id}/connect?${t}`}refreshTokenUrl(){return`${this.hostname}/${this.id}/refresh-token`}fileUrl(e){return`${this.hostname}/${this.id}/get/${e}`}async request(){await S(this,k)[k];try{return await super.request(...arguments)}catch(e){if(!e.isAuthError)throw e;return await S(this,k)[k],S(this,k)[k]=(async()=>{try{const e=await super.request({path:this.refreshTokenUrl(),method:"POST"});await this.setAuthToken(e.uppyAuthToken)}finally{S(this,k)[k]=void 0}})(),await S(this,k)[k],super.request(...arguments)}}async fetchPreAuthToken(){if(this.companionKeysParams)try{const e=await this.post(`${this.id}/preauth/`,{params:this.companionKeysParams});this.preAuthToken=e.token}catch(e){this.uppy.log(`[CompanionClient] unable to fetch preAuthToken ${e}`,"warning")}}list(e,t){return this.get(`${this.id}/list/${e||""}`,t)}async logout(){const e=await this.get(`${this.id}/logout`);return await S(this,E)[E](),e}static initPlugin(e,t,r){if(e.type="acquirer",e.files=[],r&&(e.opts={...r,...t}),t.serverUrl||t.serverPattern)throw new Error("`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`");if(t.companionAllowedHosts){const r=t.companionAllowedHosts;if(!("string"==typeof r||Array.isArray(r)||r instanceof RegExp))throw new TypeError(`${e.id}: the option "companionAllowedHosts" must be one of string, Array, RegExp`);e.opts.companionAllowedHosts=r}else/^(?!https?:\/\/).*$/i.test(t.companionUrl)?e.opts.companionAllowedHosts=`https://${t.companionUrl.replace(/^\/\//,"")}`:e.opts.companionAllowedHosts=new URL(t.companionUrl).origin;e.storage=e.opts.storage||i}}async function j(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)}async function T(){return this.uppy.getPlugin(this.pluginId).storage.removeItem(this.tokenKey)}var F=r(4800);let R,A;function C(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var D=0;function I(e){return"__private_"+D+++"_"+e}var L=I("queued"),N=I("emitter"),q=I("isOpen"),$=I("socket"),z=I("handleMessage");R=Symbol.for("uppy test: getSocket"),A=Symbol.for("uppy test: getQueued");class M{constructor(e){Object.defineProperty(this,L,{writable:!0,value:[]}),Object.defineProperty(this,N,{writable:!0,value:F()}),Object.defineProperty(this,q,{writable:!0,value:!1}),Object.defineProperty(this,$,{writable:!0,value:void 0}),Object.defineProperty(this,z,{writable:!0,value:e=>{try{const t=JSON.parse(e.data);this.emit(t.action,t.payload)}catch(e){}}}),this.opts=e,e&&!1===e.autoOpen||this.open()}get isOpen(){return C(this,q)[q]}[R](){return C(this,$)[$]}[A](){return C(this,L)[L]}open(){null==C(this,$)[$]&&(C(this,$)[$]=new WebSocket(this.opts.target),C(this,$)[$].onopen=()=>{for(C(this,q)[q]=!0;C(this,L)[L].length>0&&C(this,q)[q];){const e=C(this,L)[L].shift();this.send(e.action,e.payload)}},C(this,$)[$].onclose=()=>{C(this,q)[q]=!1,C(this,$)[$]=null},C(this,$)[$].onmessage=C(this,z)[z])}close(){var e;null==(e=C(this,$)[$])||e.close()}send(e,t){C(this,q)[q]?C(this,$)[$].send(JSON.stringify({action:e,payload:t})):C(this,L)[L].push({action:e,payload:t})}on(e,t){C(this,N)[N].on(e,t)}emit(e,t){C(this,N)[N].emit(e,t)}once(e,t){C(this,N)[N].once(e,t)}}},8596:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var i=r(4136);class n{constructor(e,t){void 0===t&&(t={}),this.uppy=e,this.opts=t}getPluginState(){const{plugins:e}=this.uppy.getState();return e[this.id]||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(),this.i18nInit()}i18nInit(){const e=new i.Z([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState()}addTarget(){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}render(){throw new Error("Extend the render method to add your plugin to a DOM element")}update(){}afterUpdate(){}}},4060:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var i=r(8596);function n(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var s=0;function o(e){return"__private_"+s+++"_"+e}var a=o("queueRequestSocketToken");class l extends i.Z{constructor(){super(...arguments),Object.defineProperty(this,a,{writable:!0,value:void 0})}setQueueRequestSocketToken(e){n(this,a)[a]=e}async uploadRemoteFile(e,t){void 0===t&&(t={});try{if(e.serverToken)return await this.connectToServerSocket(e);const r=await n(this,a)[a](e).abortOn(t.signal);if(!this.uppy.getState().files[e.id])return;return this.uppy.setFileState(e.id,{serverToken:r}),await this.connectToServerSocket(this.uppy.getFile(e.id))}catch(t){var r;if("AbortError"===(null==t||null==(r=t.cause)?void 0:r.name))return;throw this.uppy.setFileState(e.id,{serverToken:void 0}),this.uppy.emit("upload-error",e,t),t}}}},6037:function(e,t,r){"use strict";r.d(t,{di:function(){return Pe},ZP:function(){return de}});var i=r(4136),n=r(4800),s=r(9022),o=r(3493);function a(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var l=0;function u(e){return"__private_"+l+++"_"+e}var h=u("callbacks"),c=u("publish");class p{constructor(){Object.defineProperty(this,c,{value:d}),Object.defineProperty(this,h,{writable:!0,value:new Set}),this.state={}}getState(){return this.state}setState(e){const t={...this.state},r={...this.state,...e};this.state=r,a(this,c)[c](t,r,e)}subscribe(e){return a(this,h)[h].add(e),()=>{a(this,h)[h].delete(e)}}}function d(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];a(this,h)[h].forEach((e=>{e(...t)}))}p.VERSION="3.0.3";var f=p;function g(e){const t=e.lastIndexOf(".");return-1===t||t===e.length-1?{name:e,extension:void 0}:{name:e.slice(0,t),extension:e.slice(t+1)}}var m={md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function y(e){var t;if(e.type)return e.type;const r=e.name?null==(t=g(e.name).extension)?void 0:t.toLowerCase():null;return r&&r in m?m[r]:"application/octet-stream"}function v(e){let t="";return e.replace(/[^A-Z0-9]/gi,(e=>(t+=`-${function(e){return e.charCodeAt(0).toString(32)}(e)}`,"/")))+t}function b(e){if(function(e){return!(!e.isRemote||!e.remote)&&new Set(["box","dropbox","drive","facebook","unsplash"]).has(e.remote.provider)}(e))return e.id;const t=y(e);return function(e){let t="uppy";return"string"==typeof e.name&&(t+=`-${v(e.name.toLowerCase())}`),void 0!==e.type&&(t+=`-${e.type}`),e.meta&&"string"==typeof e.meta.relativePath&&(t+=`-${v(e.meta.relativePath.toLowerCase())}`),void 0!==e.data.size&&(t+=`-${e.data.size}`),void 0!==e.data.lastModified&&(t+=`-${e.data.lastModified}`),t}({...e,type:t})}function w(e){if(null==e&&"undefined"!=typeof navigator&&(e=navigator.userAgent),!e)return!0;const t=/Edge\/(\d+\.\d+)/.exec(e);if(!t)return!0;const r=t[1];let[i,n]=r.split(".");return i=parseInt(i,10),n=parseInt(n,10),i<15||15===i&&n<15063||(i>18||18===i&&n>=18218)}const O={debug:()=>{},warn:()=>{},error:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r]}},S={debug:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r]},warn:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r]},error:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r]}};var P=r(5158),_=r(4193);const k={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class U extends Error{constructor(e,t){let{isUserFacing:r=!0,file:i}=void 0===t?{}:t;super(e),this.isRestriction=!0,this.isUserFacing=r,null!=i&&(this.file=i)}}class E{constructor(e,t){this.i18n=t,this.getOpts=()=>{const t=e();if(null!=t.restrictions.allowedFileTypes&&!Array.isArray(t.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return t}}validateAggregateRestrictions(e,t){const{maxTotalFileSize:r,maxNumberOfFiles:i}=this.getOpts().restrictions;if(i){if(e.filter((e=>!e.isGhost)).length+t.length>i)throw new U(`${this.i18n("youCanOnlyUploadX",{smart_count:i})}`)}if(r){let i=e.reduce(((e,t)=>e+t.size),0);for(const e of t)if(null!=e.size&&(i+=e.size,i>r))throw new U(this.i18n("exceedsSize",{size:P(r),file:e.name}))}}validateSingleFile(e){const{maxFileSize:t,minFileSize:r,allowedFileTypes:i}=this.getOpts().restrictions;if(i){if(!i.some((t=>t.includes("/")?!!e.type&&_(e.type.replace(/;.*?$/,""),t):!("."!==t[0]||!e.extension)&&e.extension.toLowerCase()===t.slice(1).toLowerCase()))){const t=i.join(", ");throw new U(this.i18n("youCanOnlyUploadFileTypes",{types:t}),{file:e})}}if(t&&null!=e.size&&e.size>t)throw new U(this.i18n("exceedsSize",{size:P(t),file:e.name}),{file:e});if(r&&null!=e.size&&e.size<r)throw new U(this.i18n("inferiorSize",{size:P(r)}),{file:e})}validate(e,t){t.forEach((e=>{this.validateSingleFile(e)})),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(Object.keys(e).length<t)throw new U(this.i18n("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){const t=new U(this.i18n("missingRequiredMetaFieldOnFile",{fileName:e.name})),{requiredMetaFields:r}=this.getOpts().restrictions,i=[];for(const t of r)Object.hasOwn(e.meta,t)&&""!==e.meta[t]||i.push(t);return{missingFields:i,error:t}}}var x={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled"}};let j,T;function F(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var R=0;function A(e){return"__private_"+R+++"_"+e}var C=A("plugins"),D=A("restricter"),I=A("storeUnsubscribe"),L=A("emitter"),N=A("preProcessors"),q=A("uploaders"),$=A("postProcessors"),z=A("informAndEmit"),M=A("checkRequiredMetaFieldsOnFile"),B=A("checkRequiredMetaFields"),H=A("assertNewUploadAllowed"),V=A("transformFile"),K=A("startIfAutoProceed"),X=A("checkAndUpdateFileState"),G=A("addListeners"),W=A("updateOnlineStatus"),Z=A("createUpload"),Y=A("getUpload"),J=A("removeUpload"),Q=A("runUpload");j=Symbol.for("uppy test: getPlugins"),T=Symbol.for("uppy test: createUpload");class ee{constructor(e){Object.defineProperty(this,Q,{value:pe}),Object.defineProperty(this,J,{value:ce}),Object.defineProperty(this,Y,{value:he}),Object.defineProperty(this,Z,{value:ue}),Object.defineProperty(this,G,{value:le}),Object.defineProperty(this,X,{value:ae}),Object.defineProperty(this,K,{value:oe}),Object.defineProperty(this,V,{value:se}),Object.defineProperty(this,H,{value:ne}),Object.defineProperty(this,B,{value:ie}),Object.defineProperty(this,M,{value:re}),Object.defineProperty(this,z,{value:te}),Object.defineProperty(this,C,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,D,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:n()}),Object.defineProperty(this,N,{writable:!0,value:new Set}),Object.defineProperty(this,q,{writable:!0,value:new Set}),Object.defineProperty(this,$,{writable:!0,value:new Set}),this.calculateProgress=o(((e,t)=>{const r=this.getFile(null==e?void 0:e.id);if(null==e||!r)return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);if(100===r.progress.percentage)return void this.log(`Not setting progress for a file that has been already uploaded: ${e.id}`);const i=Number.isFinite(t.bytesTotal)&&t.bytesTotal>0;this.setFileState(e.id,{progress:{...r.progress,bytesUploaded:t.bytesUploaded,bytesTotal:t.bytesTotal,percentage:i?Math.round(t.bytesUploaded/t.bytesTotal*100):0}}),this.calculateTotalProgress()}),500,{leading:!0,trailing:!0}),Object.defineProperty(this,W,{writable:!0,value:this.updateOnlineStatus.bind(this)}),this.defaultLocale=x;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:k,meta:{},onBeforeFileAdded:e=>e,onBeforeUpload:e=>e,store:new f,logger:O,infoTimeout:5e3};this.opts={...t,...e,restrictions:{...t.restrictions,...e&&e.restrictions}},e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=S),this.log(`Using Core v${this.constructor.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({plugins:{},files:{},currentUploads:{},allowNewUpload:!0,capabilities:{uploadProgress:w(),individualCancellation:!0,resumableUploads:!1},totalProgress:0,meta:{...this.opts.meta},info:[],recoveredState:null}),F(this,D)[D]=new E((()=>this.opts),this.i18n),F(this,I)[I]=this.store.subscribe(((e,t,r)=>{this.emit("state-update",e,t,r),this.updateAll(t)})),this.opts.debug&&"undefined"!=typeof window&&(window[this.opts.id]=this),F(this,G)[G]()}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];F(this,L)[L].emit(e,...r)}on(e,t){return F(this,L)[L].on(e,t),this}once(e,t){return F(this,L)[L].once(e,t),this}off(e,t){return F(this,L)[L].off(e,t),this}updateAll(e){this.iteratePlugins((t=>{t.update(e)}))}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){const t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map((e=>{let[r,i]=e;return[r,{...t[r],...i}]})))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Cant set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){const e=new i.Z([this.defaultLocale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.locale=e.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e&&e.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins((t=>{t.setOptions(e)})),this.setState()}resetProgress(){const e={percentage:0,bytesUploaded:0,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},r={};Object.keys(t).forEach((i=>{r[i]={...t[i],progress:{...t[i].progress,...e}}})),this.setState({files:r,totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null}),this.emit("reset-progress")}addPreProcessor(e){F(this,N)[N].add(e)}removePreProcessor(e){return F(this,N)[N].delete(e)}addPostProcessor(e){F(this,$)[$].add(e)}removePostProcessor(e){return F(this,$)[$].delete(e)}addUploader(e){F(this,q)[q].add(e)}removeUploader(e){return F(this,q)[q].delete(e)}setMeta(e){const t={...this.getState().meta,...e},r={...this.getState().files};Object.keys(r).forEach((t=>{r[t]={...r[t],meta:{...r[t].meta,...e}}})),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:r})}setFileMeta(e,t){const r={...this.getState().files};if(!r[e])return void this.log("Was trying to set metadata for a file that has been removed: ",e);const i={...r[e].meta,...t};r[e]={...r[e],meta:i},this.setState({files:r})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map((e=>this.getFile(e)))}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:r}=this.getState(),i=Object.values(e),n=i.filter((e=>{let{progress:t}=e;return!t.uploadComplete&&t.uploadStarted})),s=i.filter((e=>!e.progress.uploadStarted)),o=i.filter((e=>e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess)),a=i.filter((e=>e.progress.uploadStarted)),l=i.filter((e=>e.isPaused)),u=i.filter((e=>e.progress.uploadComplete)),h=i.filter((e=>e.error)),c=n.filter((e=>!e.isPaused)),p=i.filter((e=>e.progress.preprocess||e.progress.postprocess));return{newFiles:s,startedFiles:o,uploadStartedFiles:a,pausedFiles:l,completeFiles:u,erroredFiles:h,inProgressFiles:n,inProgressNotPausedFiles:c,processingFiles:p,isUploadStarted:a.length>0,isAllComplete:100===t&&u.length===i.length&&0===p.length,isAllErrored:!!r&&h.length===i.length,isAllPaused:0!==n.length&&l.length===n.length,isUploadInProgress:n.length>0,isSomeGhost:i.some((e=>e.isGhost))}}validateRestrictions(e,t){void 0===t&&(t=this.getFiles());try{F(this,D)[D].validate(t,[e])}catch(e){return e}return null}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!(!t[e]||t[e].isGhost)}addFile(e){F(this,H)[H](e);const{nextFilesState:t,validFilesToAdd:r,errors:i}=F(this,X)[X]([e]),n=i.filter((e=>e.isRestriction));if(F(this,z)[z](n),i.length>0)throw i[0];this.setState({files:t});const[s]=r;return this.emit("file-added",s),this.emit("files-added",r),this.log(`Added file: ${s.name}, ${s.id}, mime type: ${s.type}`),F(this,K)[K](),s.id}addFiles(e){F(this,H)[H]();const{nextFilesState:t,validFilesToAdd:r,errors:i}=F(this,X)[X](e),n=i.filter((e=>e.isRestriction));F(this,z)[z](n);const s=i.filter((e=>!e.isRestriction));if(s.length>0){let e="Multiple errors occurred while adding files:\n";if(s.forEach((t=>{e+=`\n * ${t.message}`})),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:s.length}),details:e},"error",this.opts.infoTimeout),"function"==typeof AggregateError)throw new AggregateError(s,e);{const t=new Error(e);throw t.errors=s,t}}this.setState({files:t}),r.forEach((e=>{this.emit("file-added",e)})),this.emit("files-added",r),r.length>5?this.log(`Added batch of ${r.length} files`):Object.values(r).forEach((e=>{this.log(`Added file: ${e.name}\n id: ${e.id}\n type: ${e.type}`)})),r.length>0&&F(this,K)[K]()}removeFiles(e,t){const{files:r,currentUploads:i}=this.getState(),n={...r},s={...i},o=Object.create(null);function a(e){return void 0===o[e]}e.forEach((e=>{r[e]&&(o[e]=r[e],delete n[e])})),Object.keys(s).forEach((e=>{const t=i[e].fileIDs.filter(a);if(0===t.length)return void delete s[e];const{capabilities:r}=this.getState();if(t.length!==i[e].fileIDs.length&&!r.individualCancellation)throw new Error("individualCancellation is disabled");s[e]={...i[e],fileIDs:t}}));const l={currentUploads:s,files:n};0===Object.keys(n).length&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),this.calculateTotalProgress();const u=Object.keys(o);u.forEach((e=>{this.emit("file-removed",o[e],t)})),u.length>5?this.log(`Removed ${u.length} files`):this.log(`Removed files: ${u.join(", ")}`)}removeFile(e,t){void 0===t&&(t=null),this.removeFiles([e],t)}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).uploadComplete)return;const t=!(this.getFile(e).isPaused||!1);return this.setFileState(e,{isPaused:t}),this.emit("upload-pause",e,t),t}pauseAll(){const e={...this.getState().files};Object.keys(e).filter((t=>!e[t].progress.uploadComplete&&e[t].progress.uploadStarted)).forEach((t=>{const r={...e[t],isPaused:!0};e[t]=r})),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter((t=>!e[t].progress.uploadComplete&&e[t].progress.uploadStarted)).forEach((t=>{const r={...e[t],isPaused:!1,error:null};e[t]=r})),this.setState({files:e}),this.emit("resume-all")}retryAll(){const e={...this.getState().files},t=Object.keys(e).filter((t=>e[t].error));if(t.forEach((t=>{const r={...e[t],isPaused:!1,error:null};e[t]=r})),this.setState({files:e,error:null}),this.emit("retry-all",t),0===t.length)return Promise.resolve({successful:[],failed:[]});const r=F(this,Z)[Z](t,{forceAllowNewUpload:!0});return F(this,Q)[Q](r)}cancelAll(e){let{reason:t="user"}=void 0===e?{}:e;if(this.emit("cancel-all",{reason:t}),"user"===t){const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t,"cancel-all"),this.setState({totalProgress:0,error:null,recoveredState:null})}}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",e);const t=F(this,Z)[Z]([e],{forceAllowNewUpload:!0});return F(this,Q)[Q](t)}logout(){this.iteratePlugins((e=>{e.provider&&e.provider.logout&&e.provider.logout()}))}calculateTotalProgress(){const e=this.getFiles().filter((e=>e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess));if(0===e.length)return this.emit("progress",0),void this.setState({totalProgress:0});const t=e.filter((e=>null!=e.progress.bytesTotal)),r=e.filter((e=>null==e.progress.bytesTotal));if(0===t.length){const t=100*e.length,i=r.reduce(((e,t)=>e+t.progress.percentage),0),n=Math.round(i/t*100);return void this.setState({totalProgress:n})}let i=t.reduce(((e,t)=>e+t.progress.bytesTotal),0);const n=i/t.length;i+=n*r.length;let s=0;t.forEach((e=>{s+=e.progress.bytesUploaded})),r.forEach((e=>{s+=n*(e.progress.percentage||0)/100}));let o=0===i?0:Math.round(s/i*100);o>100&&(o=100),this.setState({totalProgress:o}),this.emit("progress",o)}updateOnlineStatus(){void 0===window.navigator.onLine||window.navigator.onLine?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e,t){if("function"!=typeof e){throw new TypeError(`Expected a plugin class, but got ${null===e?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`)}const r=new e(this,t),i=r.id;if(!i)throw new Error("Your plugin must have an id");if(!r.type)throw new Error("Your plugin must have a type");const n=this.getPlugin(i);if(n){const e=`Already found a plugin named '${n.id}'. Tried to use: '${i}'.\nUppy plugins must have unique \`id\` options. See https://uppy.io/docs/plugins/#id.`;throw new Error(e)}return e.VERSION&&this.log(`Using ${i} v${e.VERSION}`),r.type in F(this,C)[C]?F(this,C)[C][r.type].push(r):F(this,C)[C][r.type]=[r],r.install(),this}getPlugin(e){for(const t of Object.values(F(this,C)[C])){const r=t.find((t=>t.id===e));if(null!=r)return r}}[j](e){return F(this,C)[C][e]}iteratePlugins(e){Object.values(F(this,C)[C]).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=F(this,C)[C][e.type],r=t.findIndex((t=>t.id===e.id));-1!==r&&t.splice(r,1);const i={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(i)}close(e){let{reason:t}=void 0===e?{}:e;this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll({reason:t}),F(this,I)[I](),this.iteratePlugins((e=>{this.removePlugin(e)})),"undefined"!=typeof window&&window.removeEventListener&&(window.removeEventListener("online",F(this,W)[W]),window.removeEventListener("offline",F(this,W)[W]))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t,r){void 0===t&&(t="info"),void 0===r&&(r=3e3);const i="object"==typeof e;this.setState({info:[...this.getState().info,{type:t,message:i?e.message:e,details:i?e.details:null}]}),setTimeout((()=>this.hideInfo()),r),this.emit("info-visible")}log(e,t){const{logger:r}=this.opts;switch(t){case"error":r.error(e);break;case"warning":r.warn(e);break;default:r.debug(e)}}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?F(this,Q)[Q](e):(F(this,J)[J](e),Promise.reject(new Error("Nonexistent upload")))}[T](){return F(this,Z)[Z](...arguments)}addResultData(e,t){if(!F(this,Y)[Y](e))return void this.log(`Not setting result for an upload that has been removed: ${e}`);const{currentUploads:r}=this.getState(),i={...r[e],result:{...r[e].result,...t}};this.setState({currentUploads:{...r,[e]:i}})}upload(){var e;null!=(e=F(this,C)[C].uploader)&&e.length||this.log("No uploader type plugins are used","warning");let{files:t}=this.getState();const r=this.opts.onBeforeUpload(t);return!1===r?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(r&&"object"==typeof r&&(t=r,this.setState({files:t})),Promise.resolve().then((()=>F(this,D)[D].validateMinNumberOfFiles(t))).catch((e=>{throw F(this,z)[z]([e]),e})).then((()=>{if(!F(this,B)[B](t))throw new U(this.i18n("missingRequiredMetaField"))})).catch((e=>{throw e})).then((()=>{const{currentUploads:e}=this.getState(),r=Object.values(e).flatMap((e=>e.fileIDs)),i=[];Object.keys(t).forEach((e=>{const t=this.getFile(e);t.progress.uploadStarted||-1!==r.indexOf(e)||i.push(t.id)}));const n=F(this,Z)[Z](i);return F(this,Q)[Q](n)})).catch((e=>{throw this.emit("error",e),this.log(e,"error"),e})))}}function te(e){for(const t of e){const{file:e,isRestriction:r}=t;r?this.emit("restriction-failed",e,t):this.emit("error",t),this.log(t,"warning")}const t=e.filter((e=>e.isUserFacing)),r=t.slice(0,4),i=t.slice(4);r.forEach((e=>{let{message:t,details:r=""}=e;this.info({message:t,details:r},"error",this.opts.infoTimeout)})),i.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:i.length})})}function re(e){const{missingFields:t,error:r}=F(this,D)[D].getMissingRequiredMetaFields(e);return!(t.length>0)||(this.setFileState(e.id,{missingRequiredMetaFields:t}),this.log(r.message),this.emit("restriction-failed",e,r),!1)}function ie(e){let t=!0;for(const r of Object.values(e))F(this,M)[M](r)||(t=!1);return t}function ne(e){const{allowNewUpload:t}=this.getState();if(!1===t){const t=new U(this.i18n("noMoreFilesAllowed"),{file:e});throw F(this,z)[z]([t]),t}}function se(e){const t=e instanceof File?{name:e.name,type:e.type,size:e.size,data:e}:e,r=y(t),i=function(e,t){return t.name?t.name:"image"===e.split("/")[0]?`${e.split("/")[0]}.${e.split("/")[1]}`:"noname"}(r,t),n=g(i).extension,s=Boolean(t.isRemote),o=b(t),a=t.meta||{};a.name=i,a.type=r;const l=Number.isFinite(t.data.size)?t.data.size:null;return{source:t.source||"",id:o,name:i,extension:n||"",meta:{...this.getState().meta,...a},type:r,data:t.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:l,uploadComplete:!1,uploadStarted:null},size:l,isRemote:s,remote:t.remote||"",preview:t.preview}}function oe(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout((()=>{this.scheduledAutoProceed=null,this.upload().catch((e=>{e.isRestriction||this.log(e.stack||e.message||e)}))}),4))}function ae(e){const{files:t}=this.getState(),r={...t},i=[],n=[];for(const o of e)try{var s;let e=F(this,V)[V](o);if(null!=(s=t[e.id])&&s.isGhost){const{isGhost:r,...i}=t[e.id];e={...i,data:o.data},this.log(`Replaced the blob in the restored ghost file: ${e.name}, ${e.id}`)}if(this.checkIfFileAlreadyExists(e.id))throw new U(this.i18n("noDuplicates",{fileName:e.name}),{file:o});const n=this.opts.onBeforeFileAdded(e,r);if(!1===n)throw new U("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:o});"object"==typeof n&&null!==n&&(e=n),F(this,D)[D].validateSingleFile(e),r[e.id]=e,i.push(e)}catch(e){n.push(e)}try{F(this,D)[D].validateAggregateRestrictions(Object.values(t),i)}catch(e){return n.push(e),{nextFilesState:t,validFilesToAdd:[],errors:n}}return{nextFilesState:r,validFilesToAdd:i,errors:n}}function le(){const e=(e,t,r)=>{let i=e.message||"Unknown error";e.details&&(i+=` ${e.details}`),this.setState({error:i}),null!=t&&t.id in this.getState().files&&this.setFileState(t.id,{error:i,response:r})};let t;this.on("error",e),this.on("upload-error",((t,r,i)=>{if(e(r,t,i),"object"==typeof r&&r.message){this.log(r.message,"error");const e=new Error(this.i18n("failedToUpload",{file:null==t?void 0:t.name}));e.isUserFacing=!0,e.details=r.message,r.details&&(e.details+=` ${r.details}`),F(this,z)[z]([e])}else F(this,z)[z]([r])})),this.on("upload-stalled",((e,r)=>{const{message:i}=e,n=r.map((e=>e.meta.name)).join(", ");t||(this.info({message:i,details:n},"warning",this.opts.infoTimeout),t=setTimeout((()=>{t=null}),this.opts.infoTimeout)),this.log(`${i} ${n}`.trim(),"warning")})),this.on("upload",(()=>{this.setState({error:null})}));const r=e=>{const t=e.filter((e=>{const t=null!=e&&this.getFile(e.id);return t||this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`),t})),r=Object.fromEntries(t.map((e=>[e.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:e.size}}])));this.patchFilesState(r)};this.on("upload-start",(e=>{e.forEach((e=>{this.emit("upload-started",e)})),r(e)})),this.on("upload-progress",this.calculateProgress),this.on("upload-success",((e,t)=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const r=this.getFile(e.id).progress;this.setFileState(e.id,{progress:{...r,postprocess:F(this,$)[$].size>0?{mode:"indeterminate"}:null,uploadComplete:!0,percentage:100,bytesUploaded:r.bytesTotal},response:t,uploadURL:t.uploadURL,isPaused:!1}),null==e.size&&this.setFileState(e.id,{size:t.bytesUploaded||r.bytesTotal}),this.calculateTotalProgress()})),this.on("preprocess-progress",((e,t)=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{...this.getFile(e.id).progress,preprocess:t}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("preprocess-complete",(e=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const t={...this.getState().files};t[e.id]={...t[e.id],progress:{...t[e.id].progress}},delete t[e.id].progress.preprocess,this.setState({files:t})})),this.on("postprocess-progress",((e,t)=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{...this.getState().files[e.id].progress,postprocess:t}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("postprocess-complete",(e=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const t={...this.getState().files};t[e.id]={...t[e.id],progress:{...t[e.id].progress}},delete t[e.id].progress.postprocess,this.setState({files:t})})),this.on("restored",(()=>{this.calculateTotalProgress()})),this.on("dashboard:file-edit-complete",(e=>{e&&F(this,M)[M](e)})),"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("online",F(this,W)[W]),window.addEventListener("offline",F(this,W)[W]),setTimeout(F(this,W)[W],3e3))}function ue(e,t){void 0===t&&(t={});const{forceAllowNewUpload:r=!1}=t,{allowNewUpload:i,currentUploads:n}=this.getState();if(!i&&!r)throw new Error("Cannot create a new upload: already uploading.");const o=(0,s.x)();return this.emit("upload",{id:o,fileIDs:e}),this.setState({allowNewUpload:!1!==this.opts.allowMultipleUploadBatches&&!1!==this.opts.allowMultipleUploads,currentUploads:{...n,[o]:{fileIDs:e,step:0,result:{}}}}),o}function he(e){const{currentUploads:t}=this.getState();return t[e]}function ce(e){const t={...this.getState().currentUploads};delete t[e],this.setState({currentUploads:t})}async function pe(e){const t=()=>{const{currentUploads:t}=this.getState();return t[e]};let r=t();const i=[...F(this,N)[N],...F(this,q)[q],...F(this,$)[$]];try{for(let n=r.step||0;n<i.length&&r;n++){const s=i[n];this.setState({currentUploads:{...this.getState().currentUploads,[e]:{...r,step:n}}});const{fileIDs:o}=r;await s(o,e),r=t()}}catch(t){throw F(this,J)[J](e),t}if(r){r.fileIDs.forEach((e=>{const t=this.getFile(e);t&&t.progress.postprocess&&this.emit("postprocess-complete",t)}));const i=r.fileIDs.map((e=>this.getFile(e))),n=i.filter((e=>!e.error)),s=i.filter((e=>e.error));await this.addResultData(e,{successful:n,failed:s,uploadID:e}),r=t()}let n;return r&&(n=r.result,this.emit("complete",n),F(this,J)[J](e)),null==n&&this.log(`Not setting result for an upload that has been removed: ${e}`),n}ee.VERSION="3.3.1";var de=ee,fe=r(6400);function ge(e,t){return void 0===t&&(t=document),"string"==typeof e?t.querySelector(e):(null==(r=e)?void 0:r.nodeType)===Node.ELEMENT_NODE?e:null;var r}var me=function(e){for(var t;e&&!e.dir;)e=e.parentNode;return null==(t=e)?void 0:t.dir},ye=r(8596);function ve(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var be=0;function we(e){return"__private_"+be+++"_"+e}var Oe=we("updateUI");class Se extends ye.Z{constructor(){super(...arguments),Object.defineProperty(this,Oe,{writable:!0,value:void 0})}getTargetPlugin(e){let t;if("object"==typeof e&&e instanceof Se)t=e;else if("function"==typeof e){const r=e;this.uppy.iteratePlugins((e=>{e instanceof r&&(t=e)}))}return t}mount(e,t){const r=t.id,i=ge(e);if(i){this.isTargetDOMEl=!0;const t=document.createElement("div");return t.classList.add("uppy-Root"),ve(this,Oe)[Oe]=function(e){let t=null,r=null;return function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return r=n,t||(t=Promise.resolve().then((()=>(t=null,e(...r))))),t}}((e=>{this.uppy.getPlugin(this.id)&&((0,fe.sY)(this.render(e),t),this.afterUpdate())})),this.uppy.log(`Installing ${r} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(i.innerHTML=""),(0,fe.sY)(this.render(this.uppy.getState()),t),this.el=t,i.appendChild(t),t.dir=this.opts.direction||me(t)||"ltr",this.onMount(),this.el}const n=this.getTargetPlugin(e);if(n)return this.uppy.log(`Installing ${r} to ${n.id}`),this.parent=n,this.el=n.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${r}`);let s=`Invalid target option given to ${r}.`;throw s+="function"==typeof e?" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":"If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(s)}update(e){var t,r;null!=this.el&&(null==(t=(r=ve(this,Oe))[Oe])||t.call(r,e))}unmount(){var e;this.isTargetDOMEl&&(null==(e=this.el)||e.remove());this.onUnmount()}onMount(){}onUnmount(){}}var Pe=Se},4136:function(e,t,r){"use strict";function i(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}r.d(t,{Z:function(){return u}});var n=0;function s(e){return"__private_"+n+++"_"+e}function o(e,t,r){const i=[];return e.forEach((e=>"string"!=typeof e?i.push(e):t[Symbol.split](e).forEach(((e,t,n)=>{""!==e&&i.push(e),t<n.length-1&&i.push(r)})))),i}function a(e,t){const r=/\$/g;let i=[e];if(null==t)return i;for(const e of Object.keys(t))if("_"!==e){let n=t[e];"string"==typeof n&&(n=r[Symbol.replace](n,"$$$$")),i=o(i,new RegExp(`%\\{${e}\\}`,"g"),n)}return i}var l=s("apply");class u{constructor(e){Object.defineProperty(this,l,{value:h}),this.locale={strings:{},pluralize(e){return 1===e?0:1}},Array.isArray(e)?e.forEach(i(this,l)[l],this):i(this,l)[l](e)}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){if(!function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(this.locale.strings,e))throw new Error(`missing string: ${e}`);const r=this.locale.strings[e];if("object"==typeof r){if(t&&void 0!==t.smart_count){return a(r[this.locale.pluralize(t.smart_count)],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}return a(r,t)}}function h(e){if(null==e||!e.strings)return;const t=this.locale;this.locale={...t,strings:{...t.strings,...e.strings}},this.locale.pluralize=e.pluralize||t.pluralize}},7049:function(e,t,r){"use strict";r.d(t,{Z:function(){return _e}});var i=r(6037);const n=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function s(e){return e.startsWith("blob:")}function o(e){return!!e&&/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(e)}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l="undefined"!=typeof self?self:global;const u="undefined"!=typeof navigator,h=u&&"undefined"==typeof HTMLImageElement,c=!("undefined"==typeof global||"undefined"==typeof process||!process.versions||!process.versions.node),p=l.Buffer,d=!!p,f=e=>void 0!==e;function g(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(f).length)}function m(e){let t=new Error(e);throw delete t.stack,t}function y(e){let t=function(e){let t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const v=e=>String.fromCharCode.apply(null,e),b="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;class w{static from(e,t){return e instanceof this&&e.le===t?e:new w(e,void 0,void 0,t)}constructor(e,t=0,r,i){if("boolean"==typeof i&&(this.le=i),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===r&&(r=e.byteLength-t);let i=new DataView(e,t,r);this._swapDataView(i)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof w){void 0===r&&(r=e.byteLength-t),(t+=e.byteOffset)+r>e.byteOffset+e.byteLength&&m("Creating view outside of available memory in ArrayBuffer");let i=new DataView(e.buffer,t,r);this._swapDataView(i)}else if("number"==typeof e){let t=new DataView(new ArrayBuffer(e));this._swapDataView(t)}else m("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,r=w){return e instanceof DataView||e instanceof w?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||m("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new r(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new w(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return r=this.getUint8Array(e,t),b?b.decode(r):d?Buffer.from(r).toString("utf8"):decodeURIComponent(escape(v(r)));var r}getLatin1String(e=0,t=this.byteLength){let r=this.getUint8Array(e,t);return v(r)}getUnicodeString(e=0,t=this.byteLength){const r=[];for(let i=0;i<t&&e+i<this.byteLength;i+=2)r.push(this.getUint16(e+i));return v(r)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,r){switch(t){case 1:return this.getUint8(e,r);case 2:return this.getUint16(e,r);case 4:return this.getUint32(e,r);case 8:return this.getUint64&&this.getUint64(e,r)}}getUint(e,t,r){switch(t){case 8:return this.getUint8(e,r);case 16:return this.getUint16(e,r);case 32:return this.getUint32(e,r);case 64:return this.getUint64&&this.getUint64(e,r)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function O(e,t){m(`${e} '${t}' was not loaded, try using full build of exifr.`)}class S extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||O(this.kind,e),t&&(e in t||function(e,t){m(`Unknown ${e} '${t}'.`)}(this.kind,e),t[e].enabled||O(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var P=new S("file parser"),_=new S("segment parser"),k=new S("file reader");let U=l.fetch;function E(e,t){return(r=e).startsWith("data:")||r.length>1e4?j(e,t,"base64"):c&&e.includes("://")?x(e,t,"url",T):c?j(e,t,"fs"):u?x(e,t,"url",T):void m("Invalid input argument");var r}async function x(e,t,r,i){return k.has(r)?j(e,t,r):i?async function(e,t){let r=await t(e);return new w(r)}(e,i):void m(`Parser ${r} is not loaded`)}async function j(e,t,r){let i=new(k.get(r))(e,t);return await i.read(),i}const T=e=>U(e).then((e=>e.arrayBuffer())),F=e=>new Promise(((t,r)=>{let i=new FileReader;i.onloadend=()=>t(i.result||new ArrayBuffer),i.onerror=r,i.readAsArrayBuffer(e)}));class R extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function A(e,t,r){let i=new R;for(let[e,t]of r)i.set(e,t);if(Array.isArray(t))for(let r of t)e.set(r,i);else e.set(t,i);return i}function C(e,t,r){let i,n=e.get(t);for(i of r)n.set(i[0],i[1])}const D=new Map,I=new Map,L=new Map,N=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],q=["jfif","xmp","icc","iptc","ihdr"],$=["tiff",...q],z=["ifd0","ifd1","exif","gps","interop"],M=[...$,...z],B=["makerNote","userComment"],H=["translateKeys","translateValues","reviveValues","multiSegment"],V=[...H,"sanitize","mergeOutput","silentErrors"];class K{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class X extends K{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,r,i){if(super(),a(this,"enabled",!1),a(this,"skip",new Set),a(this,"pick",new Set),a(this,"deps",new Set),a(this,"translateKeys",!1),a(this,"translateValues",!1),a(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(i),this.canBeFiltered=z.includes(e),this.canBeFiltered&&(this.dict=D.get(e)),void 0!==r)if(Array.isArray(r))this.parse=this.enabled=!0,this.canBeFiltered&&r.length>0&&this.translateTagSet(r,this.pick);else if("object"==typeof r){if(this.enabled=!0,this.parse=!1!==r.parse,this.canBeFiltered){let{pick:e,skip:t}=r;e&&e.length>0&&this.translateTagSet(e,this.pick),t&&t.length>0&&this.translateTagSet(t,this.skip)}this.applyInheritables(r)}else!0===r||!1===r?this.parse=this.enabled=r:m(`Invalid options argument: ${r}`)}applyInheritables(e){let t,r;for(t of H)r=e[t],void 0!==r&&(this[t]=r)}translateTagSet(e,t){if(this.dict){let r,i,{tagKeys:n,tagValues:s}=this.dict;for(r of e)"string"==typeof r?(i=s.indexOf(r),-1===i&&(i=n.indexOf(Number(r))),-1!==i&&t.add(Number(n[i]))):t.add(r)}else for(let r of e)t.add(r)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Q(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Q(this.pick,this.deps)}}var G={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},W=new Map;class Z extends K{static useCached(e){let t=W.get(e);return void 0!==t||(t=new this(e),W.set(e,t)),t}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):"object"==typeof e?this.setupFromObject(e):m(`Invalid options argument ${e}`),void 0===this.firstChunkSize&&(this.firstChunkSize=u?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of N)this[e]=G[e];for(e of V)this[e]=G[e];for(e of B)this[e]=G[e];for(e of M)this[e]=new X(e,G[e],void 0,this)}setupFromTrue(){let e;for(e of N)this[e]=G[e];for(e of V)this[e]=G[e];for(e of B)this[e]=!0;for(e of M)this[e]=new X(e,!0,void 0,this)}setupFromArray(e){let t;for(t of N)this[t]=G[t];for(t of V)this[t]=G[t];for(t of B)this[t]=G[t];for(t of M)this[t]=new X(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,z)}setupFromObject(e){let t;for(t of(z.ifd0=z.ifd0||z.image,z.ifd1=z.ifd1||z.thumbnail,Object.assign(this,e),N))this[t]=J(e[t],G[t]);for(t of V)this[t]=J(e[t],G[t]);for(t of B)this[t]=J(e[t],G[t]);for(t of $)this[t]=new X(t,G[t],e[t],this);for(t of z)this[t]=new X(t,G[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,z,M),!0===e.tiff?this.batchEnableWithBool(z,!0):!1===e.tiff?this.batchEnableWithUserValue(z,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,z):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,z)}batchEnableWithBool(e,t){for(let r of e)this[r].enabled=t}batchEnableWithUserValue(e,t){for(let r of e){let e=t[r];this[r].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,t,r,i=r){if(e&&e.length){for(let e of i)this[e].enabled=!1;let t=Y(e,r);for(let[e,r]of t)Q(this[e].pick,r),this[e].enabled=!0}else if(t&&t.length){let e=Y(t,r);for(let[t,r]of e)Q(this[t].skip,r)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:r,iptc:i,icc:n}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),r.enabled||e.skip.add(700),i.enabled||e.skip.add(33723),n.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:r,interop:i}=this;i.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),r.needed&&e.deps.add(34853),this.tiff.enabled=z.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of z)this[e].finalizeFilters()}get onlyTiff(){return!q.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of $)this[e].enabled&&!_.has(e)&&O("segment parser",e)}}function Y(e,t){let r,i,n,s,o=[];for(n of t){for(s of(r=D.get(n),i=[],r))(e.includes(s[0])||e.includes(s[1]))&&i.push(s[0]);i.length&&o.push([n,i])}return o}function J(e,t){return void 0!==e?e:void 0!==t?t:void 0}function Q(e,t){for(let r of t)e.add(r)}a(Z,"default",G);class ee{constructor(e){a(this,"parsers",{}),a(this,"output",{}),a(this,"errors",[]),a(this,"pushToErrors",(e=>this.errors.push(e))),this.options=Z.useCached(e)}async read(e){this.file=await function(e,t){return"string"==typeof e?E(e,t):u&&!h&&e instanceof HTMLImageElement?E(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new w(e):u&&e instanceof Blob?x(e,t,"blob",F):void m("Invalid input argument")}(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[r,i]of P)if(i.canHandle(e,t))return this.fileParser=new i(this.options,this.file,this.parsers),e[r]=!0;this.file.close&&this.file.close(),m("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),g(r=e)?void 0:r;var r}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async t=>{let r=await t.parse();t.assignToOutput(e,r)}));this.options.silentErrors&&(t=t.map((e=>e.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,r=_.get("tiff",e);var i;if(t.tiff?i={start:0,type:"tiff"}:t.jpeg&&(i=await this.fileParser.getOrFindSegment("tiff")),void 0===i)return;let n=await this.fileParser.ensureSegmentChunk(i),s=this.parsers.tiff=new r(n,e,t),o=await s.extractThumbnail();return t.close&&t.close(),o}}async function te(e,t){let r=new ee(t);return await r.read(e),r.parse()}var re=Object.freeze({__proto__:null,parse:te,Exifr:ee,fileParsers:P,segmentParsers:_,fileReaders:k,tagKeys:D,tagValues:I,tagRevivers:L,createDictionary:A,extendDictionary:C,fetchUrlAsArrayBuffer:T,readBlobAsArrayBuffer:F,chunkedProps:N,otherSegments:q,segments:$,tiffBlocks:z,segmentsAndBlocks:M,tiffExtractables:B,inheritables:H,allFormatters:V,Options:Z});class ie{static findPosition(e,t){let r=e.getUint16(t+2)+2,i="function"==typeof this.headerLength?this.headerLength(e,t,r):this.headerLength,n=t+i,s=r-i;return{offset:t,length:r,headerLength:i,start:n,size:s,end:n+s}}static parse(e,t={}){return new this(e,new Z({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof w?e:new w(e)}constructor(e,t={},r){a(this,"errors",[]),a(this,"raw",new Map),a(this,"handleError",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(e),this.file=r,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let r=L.get(t),i=I.get(t),n=D.get(t),s=this.options[t],o=s.reviveValues&&!!r,a=s.translateValues&&!!i,l=s.translateKeys&&!!n,u={};for(let[t,s]of e)o&&r.has(t)?s=r.get(t)(s):a&&i.has(t)&&(s=this.translateValue(s,i.get(t))),l&&n.has(t)&&(t=n.get(t)||t),u[t]=s;return u}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,r){if(this.globalOptions.mergeOutput)return Object.assign(e,r);e[t]?Object.assign(e[t],r):e[t]=r}}function ne(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function se(e){return e>=224&&e<=239}function oe(e,t,r){for(let[i,n]of _)if(n.canHandle(e,t,r))return i}a(ie,"headerLength",4),a(ie,"type",void 0),a(ie,"multiSegment",!1),a(ie,"canHandle",(()=>!1));class ae extends class{constructor(e,t,r){a(this,"errors",[]),a(this,"ensureSegmentChunk",(async e=>{let t=e.start,r=e.size||65536;if(this.file.chunked)if(this.file.available(t,r))e.chunk=this.file.subarray(t,r);else try{e.chunk=await this.file.readChunk(t,r)}catch(t){m(`Couldn't read segment: ${JSON.stringify(e)}. ${t.message}`)}else this.file.byteLength>t+r?e.chunk=this.file.subarray(t,r):void 0===e.size?e.chunk=this.file.subarray(t):m("Segment unreachable: "+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=r}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let r=new(_.get(e))(t,this.options,this.file);return this.parsers[e]=r}createParsers(e){for(let t of e){let{type:e,chunk:r}=t,i=this.options[e];if(i&&i.enabled){let t=this.parsers[e];t&&t.append||t||this.createParser(e,r)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{constructor(...e){super(...e),a(this,"appSegments",[]),a(this,"jpegSegments",[]),a(this,"unknownSegments",[])}static canHandle(e,t){return 65496===t}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(_.keyList())):(e=void 0===e?_.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&_.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:r,findAll:i,wanted:n,remaining:s}=this;if(!i&&this.file.chunked&&(i=Array.from(n).some((e=>{let t=_.get(e),r=this.options[e];return t.multiSegment&&r.multiSegment})),i&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,r.byteLength),!this.options.onlyTiff&&r.chunked){let t=!1;for(;s.size>0&&!t&&(r.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:i}=r,n=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(t=e>i&&!n?!await r.readNextChunk(e):!await r.readNextChunk(i),void 0===(e=this.findAppSegmentsInRange(e,r.byteLength)))return}}}findAppSegmentsInRange(e,t){t-=2;let r,i,n,s,o,a,{file:l,findAll:u,wanted:h,remaining:c,options:p}=this;for(;e<t;e++)if(255===l.getUint8(e))if(r=l.getUint8(e+1),se(r)){if(i=l.getUint16(e+2),n=oe(l,e,i),n&&h.has(n)&&(s=_.get(n),o=s.findPosition(l,e),a=p[n],o.type=n,this.appSegments.push(o),!u&&(s.multiSegment&&a.multiSegment?(this.unfinishedMultiSegment=o.chunkNumber<o.chunkCount,this.unfinishedMultiSegment||c.delete(n)):c.delete(n),0===c.size)))break;p.recordUnknownSegments&&(o=ie.findPosition(l,e),o.marker=r,this.unknownSegments.push(o)),e+=i+1}else if(ne(r)){if(i=l.getUint16(e+2),218===r&&!1!==p.stopAfterSos)return;p.recordJpegSegments&&this.jpegSegments.push({offset:e,length:i,marker:r}),e+=i+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e,t){let r,i,n,s=new Map;for(let t=0;t<e.length;t++)r=e[t],i=r.type,s.has(i)?n=s.get(i):s.set(i,n=[]),n.push(r);return Array.from(s)}(this.appSegments);this.mergedAppSegments=e.map((([e,t])=>{let r=_.get(e,this.options);return r.handleMultiSegments?{type:e,chunk:r.handleMultiSegments(t)}:t[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return void 0===t&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}a(ae,"type","jpeg"),P.set("jpeg",ae);const le=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class ue extends ie{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,r=new Map){let{pick:i,skip:n}=this.options[t];i=new Set(i);let s=i.size>0,o=0===n.size,a=this.chunk.getUint16(e);e+=2;for(let l=0;l<a;l++){let a=this.chunk.getUint16(e);if(s){if(i.has(a)&&(r.set(a,this.parseTag(e,a,t)),i.delete(a),0===i.size))break}else!o&&n.has(a)||r.set(a,this.parseTag(e,a,t));e+=12}return r}parseTag(e,t,r){let{chunk:i}=this,n=i.getUint16(e+2),s=i.getUint32(e+4),o=le[n];if(o*s<=4?e+=8:e=i.getUint32(e+8),(n<1||n>13)&&m(`Invalid TIFF value type. block: ${r.toUpperCase()}, tag: ${t.toString(16)}, type: ${n}, offset ${e}`),e>i.byteLength&&m(`Invalid TIFF value offset. block: ${r.toUpperCase()}, tag: ${t.toString(16)}, type: ${n}, offset ${e} is outside of chunk size ${i.byteLength}`),1===n)return i.getUint8Array(e,s);if(2===n)return""===(a=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(a=i.getString(e,s)).trim())?void 0:a;var a;if(7===n)return i.getUint8Array(e,s);if(1===s)return this.parseTagValue(n,e);{let t=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:case 10:default:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 11:return Float32Array;case 12:return Float64Array}}(n))(s),r=o;for(let i=0;i<s;i++)t[i]=this.parseTagValue(n,e),e+=r;return t}}parseTagValue(e,t){let{chunk:r}=this;switch(e){case 1:return r.getUint8(t);case 3:return r.getUint16(t);case 4:case 13:return r.getUint32(t);case 5:return r.getUint32(t)/r.getUint32(t+4);case 6:return r.getInt8(t);case 8:return r.getInt16(t);case 9:return r.getInt32(t);case 10:return r.getInt32(t)/r.getInt32(t+4);case 11:return r.getFloat(t);case 12:return r.getDouble(t);default:m(`Invalid tiff type ${e}`)}}}class he extends ue{static canHandle(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let r=new Map;return this[t]=r,this.parseTags(e,t,r),r}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&m("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&m(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,y(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==t.size?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,y(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let r=e.get(t);r&&1===r.length&&e.set(t,r[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",ce(...e.get(2),e.get(1))),e.set("longitude",ce(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,r,i={};for(t of z)if(e=this[t],!g(e))if(r=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===t)continue;Object.assign(i,r)}else i[t]=r;return this.makerNote&&(i.makerNote=this.makerNote),this.userComment&&(i.userComment=this.userComment),i}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[r,i]of Object.entries(t))this.assignObjectToOutput(e,r,i)}}function ce(e,t,r,i){var n=e+t/60+r/3600;return"S"!==i&&"W"!==i||(n*=-1),n}a(he,"type","tiff"),a(he,"headerLength",10),_.set("tiff",he);Object.freeze({__proto__:null,default:re,Exifr:ee,fileParsers:P,segmentParsers:_,fileReaders:k,tagKeys:D,tagValues:I,tagRevivers:L,createDictionary:A,extendDictionary:C,fetchUrlAsArrayBuffer:T,readBlobAsArrayBuffer:F,chunkedProps:N,otherSegments:q,segments:$,tiffBlocks:z,segmentsAndBlocks:M,tiffExtractables:B,inheritables:H,allFormatters:V,Options:Z,parse:te});const pe={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1};Object.assign({},pe,{firstChunkSize:4e4,gps:[1,2,3,4]});Object.assign({},pe,{tiff:!1,ifd1:!0,mergeOutput:!1});const de=Object.assign({},pe,{firstChunkSize:4e4,ifd0:[274]});const fe=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let ge=!0,me=!0;if("object"==typeof navigator){let e=navigator.userAgent;if(e.includes("iPad")||e.includes("iPhone")){let t=e.match(/OS (\d+)_(\d+)/);if(t){let[,e,r]=t,i=Number(e)+.1*Number(r);ge=i<13.4,me=!1}}else if(e.includes("OS X 10")){let[,t]=e.match(/OS X 10[_.](\d+)/);ge=me=Number(t)<15}if(e.includes("Chrome/")){let[,t]=e.match(/Chrome\/(\d+)/);ge=me=Number(t)<81}else if(e.includes("Firefox/")){let[,t]=e.match(/Firefox\/(\d+)/);ge=me=Number(t)<77}}async function ye(e){let t=await async function(e){let t=new ee(de);await t.read(e);let r=await t.parse();if(r&&r.ifd0)return r.ifd0[274]}(e);return Object.assign({canvas:ge,css:me},fe[t])}class ve extends w{constructor(...e){super(...e),a(this,"ranges",new be),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,r){if(0===e&&0===this.byteLength&&r){let e=new DataView(r.buffer||r,r.byteOffset,r.byteLength);this._swapDataView(e)}else{let r=e+t;if(r>this.byteLength){let{dataView:e}=this._extend(r);this._swapDataView(e)}}}_extend(e){let t;t=d?p.allocUnsafe(e):new Uint8Array(e);let r=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:r}}subarray(e,t,r=!1){return t=t||this._lengthToEnd(e),r&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,r=!1){r&&this._tryExtend(t,e.byteLength,e);let i=super.set(e,t);return this.ranges.add(t,i.byteLength),i}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class be{constructor(){a(this,"list",[])}get length(){return this.list.length}add(e,t,r=0){let i=e+t,n=this.list.filter((t=>we(e,t.offset,i)||we(e,t.end,i)));if(n.length>0){e=Math.min(e,...n.map((e=>e.offset))),i=Math.max(i,...n.map((e=>e.end))),t=i-e;let r=n.shift();r.offset=e,r.length=t,r.end=i,this.list=this.list.filter((e=>!n.includes(e)))}else this.list.push({offset:e,length:t,end:i})}available(e,t){let r=e+t;return this.list.some((t=>t.offset<=e&&r<=t.end))}}function we(e,t,r){return e<=t&&t<=r}class Oe extends ve{constructor(e,t){super(0),a(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,r=await this.readChunk(e,t);return!!r&&r.byteLength===t}async readChunk(e,t){if(this.chunksRead++,0!==(t=this.safeWrapAddress(e,t)))return this._readChunk(e,t)}safeWrapAddress(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}k.set("blob",class extends Oe{async readWhole(){this.chunked=!1;let e=await F(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let r=t?e+t:void 0,i=this.input.slice(e,r),n=await F(i);return this.set(n,e,!0)}});var Se={strings:{generatingThumbnails:"Generating thumbnails..."}};function Pe(e,t,r){try{e.getContext("2d").getImageData(0,0,1,1)}catch(e){if(18===e.code)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return e.toBlob?new Promise((i=>{e.toBlob(i,t,r)})).then((e=>{if(null===e)throw new Error("cannot read image, probably an svg with external resources");return e})):Promise.resolve().then((()=>function(e,t,r){var i,s;const o=n.exec(e),a=null!=(i=null!=(s=t.mimeType)?s:null==o?void 0:o[1])?i:"plain/text";let l;if(null!=o[2]){const e=atob(decodeURIComponent(o[3])),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);l=[t]}else l=[decodeURIComponent(o[3])];return r?new File(l,t.name||"",{type:a}):new Blob(l,{type:a})}(e.toDataURL(t,r),{}))).then((e=>{if(null===e)throw new Error("could not extract blob, probably an old browser");return e}))}class _e extends i.di{constructor(e,t){super(e,t),this.onFileAdded=e=>{!e.preview&&e.data&&o(e.type)&&!e.isRemote&&this.addToQueue(e.id)},this.onCancelRequest=e=>{const t=this.queue.indexOf(e.id);-1!==t&&this.queue.splice(t,1)},this.onFileRemoved=e=>{const t=this.queue.indexOf(e.id);-1!==t&&this.queue.splice(t,1),e.preview&&s(e.preview)&&URL.revokeObjectURL(e.preview)},this.onRestored=()=>{this.uppy.getFiles().filter((e=>e.isRestored)).forEach((e=>{e.preview&&!s(e.preview)||this.addToQueue(e.id)}))},this.onAllFilesRemoved=()=>{this.queue=[]},this.waitUntilAllProcessed=e=>{e.forEach((e=>{const t=this.uppy.getFile(e);this.uppy.emit("preprocess-progress",t,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})}));const t=()=>{e.forEach((e=>{const t=this.uppy.getFile(e);this.uppy.emit("preprocess-complete",t)}))};return new Promise((e=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",(()=>{t(),e()})):(t(),e())}))},this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType||"image/jpeg",this.defaultLocale=Se;if(this.opts={thumbnailWidth:null,thumbnailHeight:null,waitForThumbnailsBeforeUpload:!1,lazy:!1,...t},this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(e,t,r){const i=URL.createObjectURL(e.data),n=new Promise(((e,t)=>{const r=new Image;r.src=i,r.addEventListener("load",(()=>{URL.revokeObjectURL(i),e(r)})),r.addEventListener("error",(e=>{URL.revokeObjectURL(i),t(e.error||new Error("Could not create thumbnail"))}))})),s=ye(e.data).catch((()=>1));return Promise.all([n,s]).then((e=>{let[i,n]=e;const s=this.getProportionalDimensions(i,t,r,n.deg),o=function(e,t){let r=e.width,i=e.height;90!==t.deg&&270!==t.deg||(r=e.height,i=e.width);const n=document.createElement("canvas");n.width=r,n.height=i;const s=n.getContext("2d");return s.translate(r/2,i/2),t.canvas&&(s.rotate(t.rad),s.scale(t.scaleX,t.scaleY)),s.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),n}(i,n);return Pe(this.resizeImage(o,s.width,s.height),this.thumbnailType,80)})).then((e=>URL.createObjectURL(e)))}getProportionalDimensions(e,t,r,i){let n=e.width/e.height;return 90!==i&&270!==i||(n=e.height/e.width),null!=t?{width:t,height:Math.round(t/n)}:null!=r?{width:Math.round(r*n),height:r}:{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/n)}}resizeImage(e,t,r){let i=function(e){const t=e.width/e.height,r=5e6,i=4096;let n=Math.floor(Math.sqrt(r*t)),s=Math.floor(r/Math.sqrt(r*t));if(n>i&&(n=i,s=Math.round(n/t)),s>i&&(s=i,n=Math.round(t*s)),e.width>n){const t=document.createElement("canvas");return t.width=n,t.height=s,t.getContext("2d").drawImage(e,0,0,n,s),t}return e}(e),n=Math.ceil(Math.log2(i.width/t));n<1&&(n=1);let s=t*2**(n-1),o=r*2**(n-1);for(;n--;){const e=document.createElement("canvas");e.width=s,e.height=o,e.getContext("2d").drawImage(i,0,0,s,o),i=e,s=Math.round(s/2),o=Math.round(o/2)}return i}setPreviewURL(e,t){this.uppy.setFileState(e,{preview:t})}addToQueue(e){this.queue.push(e),!1===this.queueProcessing&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){const e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch((()=>{})).then((()=>this.processQueue())):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(e){return o(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then((t=>{this.setPreviewURL(e.id,t),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(e.id),t)})).catch((t=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,"warning"),this.uppy.log(t,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(e.id),t)})):Promise.resolve()}install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}}_e.VERSION="3.0.3"},3577:function(e,t,r){"use strict";r.d(t,{Z:function(){return wt}});var i=r(4060);const n="function"==typeof btoa,s="function"==typeof Buffer,o=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder?new TextEncoder:void 0),a=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),l=((e=>{let t={};e.forEach(((e,r)=>t[e]=r))})(a),String.fromCharCode.bind(String)),u=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_"))),h=e=>{let t,r,i,n,s="";const o=e.length%3;for(let o=0;o<e.length;){if((r=e.charCodeAt(o++))>255||(i=e.charCodeAt(o++))>255||(n=e.charCodeAt(o++))>255)throw new TypeError("invalid character found");t=r<<16|i<<8|n,s+=a[t>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}return o?s.slice(0,o-3)+"===".substring(o):s},c=n?e=>btoa(e):s?e=>Buffer.from(e,"binary").toString("base64"):h,p=s?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let r=0,i=e.length;r<i;r+=4096)t.push(l.apply(null,e.subarray(r,r+4096)));return c(t.join(""))},d=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?l(192|t>>>6)+l(128|63&t):l(224|t>>>12&15)+l(128|t>>>6&63)+l(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return l(240|t>>>18&7)+l(128|t>>>12&63)+l(128|t>>>6&63)+l(128|63&t)},f=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,g=e=>e.replace(f,d),m=s?e=>Buffer.from(e,"utf8").toString("base64"):o?e=>p(o.encode(e)):e=>c(g(e)),y=(e,t=!1)=>t?u(m(e)):m(e),v=y;var b=r(4564),w=r.n(b);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function S(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function P(e){var t=U();return function(){var r,i=x(e);if(t){var n=x(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function _(e){var t="function"==typeof Map?new Map:void 0;return _=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return k(e,arguments,x(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),E(i,e)},_(e)}function k(e,t,r){return k=U()?Reflect.construct.bind():function(e,t,r){var i=[null];i.push.apply(i,t);var n=new(Function.bind.apply(e,i));return r&&E(n,r.prototype),n},k.apply(null,arguments)}function U(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(s,e);var t,r,i,n=P(s);function s(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=n.call(this,e)).originalRequest=i,t.originalResponse=o,t.causingError=r,null!=r&&(e+=", caused by ".concat(r.toString())),null!=i){var a=i.getHeader("X-Request-ID")||"n/a",l=i.getMethod(),u=i.getURL(),h=o?o.getStatus():"n/a",c=o?o.getBody()||"":"n/a";e+=", originated from request (method: ".concat(l,", url: ").concat(u,", response code: ").concat(h,", response text: ").concat(c,", request id: ").concat(a,")")}return t.message=e,t}return t=s,r&&S(t.prototype,r),i&&S(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}(_(Error)),T=j;function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var i,n,s=[],o=!0,a=!1;try{for(r=r.call(e);!(o=(i=r.next()).done)&&(s.push(i.value),!t||s.length!==t);o=!0);}catch(e){a=!0,n=e}finally{try{o||null==r.return||r.return()}finally{if(a)throw n}}return s}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var L={endpoint:null,uploadUrl:null,metadata:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:null,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null},N=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=r,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=t,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}var t,r,i;return t=e,r=[{key:"findPreviousUploads",value:function(){var e=this;return this.options.fingerprint(this.file,this.options).then((function(t){return e._urlStorage.findUploadsByFingerprint(t)}))}},{key:"resumeFromPreviousUpload",value:function(e){this.url=e.uploadUrl||null,this._parallelUploadUrls=e.parallelUploadUrls||null,this._urlStorageKey=e.urlStorageKey}},{key:"start",value:function(){var e=this,t=this.file;if(t)if(this.options.endpoint||this.options.uploadUrl||this.url){var r=this.options.retryDelays;if(null==r||"[object Array]"===Object.prototype.toString.call(r)){if(this.options.parallelUploads>1)for(var i=0,n=["uploadUrl","uploadSize","uploadLengthDeferred"];i<n.length;i++){var s=n[i];if(this.options[s])return void this._emitError(new Error("tus: cannot use the ".concat(s," option when parallelUploads is enabled")))}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1)return void this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length)return void this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"))}this.options.fingerprint(t,this.options).then((function(r){return null==r||"Calculated fingerprint: ".concat(r),e._fingerprint=r,e._source?e._source:e.options.fileReader.openFile(t,e.options.chunkSize)})).then((function(t){if(e._source=t,e.options.uploadLengthDeferred)e._size=null;else if(null!=e.options.uploadSize){if(e._size=Number(e.options.uploadSize),Number.isNaN(e._size))return void e._emitError(new Error("tus: cannot convert `uploadSize` option into a number"))}else if(e._size=e._source.size,null==e._size)return void e._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));e.options.parallelUploads>1||null!=e._parallelUploadUrls?e._startParallelUpload():e._startSingleUpload()})).catch((function(t){e._emitError(t)}))}else this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"))}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"_startParallelUpload",value:function(){var t,r=this,i=this._size,n=0;this._parallelUploads=[];var s=null!=this._parallelUploadUrls?this._parallelUploadUrls.length:this.options.parallelUploads,o=null!==(t=this.options.parallelUploadBoundaries)&&void 0!==t?t:function(e,t){for(var r=Math.floor(e/t),i=[],n=0;n<t;n++)i.push({start:r*n,end:r*(n+1)});return i[t-1].end=e,i}(this._source.size,s);this._parallelUploadUrls&&o.forEach((function(e,t){e.uploadUrl=r._parallelUploadUrls[t]||null})),this._parallelUploadUrls=new Array(o.length);var a,l=o.map((function(t,s){var a=0;return r._source.slice(t.start,t.end).then((function(l){var u=l.value;return new Promise((function(l,h){var c=C(C({},r.options),{},{uploadUrl:t.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:{},headers:C(C({},r.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:l,onError:h,onProgress:function(e){n=n-a+e,a=e,r._emitProgress(n,i)},onUploadUrlAvailable:function(){r._parallelUploadUrls[s]=p.url,r._parallelUploadUrls.filter((function(e){return Boolean(e)})).length===o.length&&r._saveUploadInUrlStorage()}}),p=new e(u,c);p.start(),r._parallelUploads.push(p)}))}))}));Promise.all(l).then((function(){(a=r._openRequest("POST",r.options.endpoint)).setHeader("Upload-Concat","final;".concat(r._parallelUploadUrls.join(" ")));var e=q(r.options.metadata);return""!==e&&a.setHeader("Upload-Metadata",e),r._sendRequest(a,null)})).then((function(e){if($(e.getStatus(),200)){var t=e.getHeader("Location");null!=t?(r.url=H(r.options.endpoint,t),"Created upload at ".concat(r.url),r._emitSuccess()):r._emitHttpError(a,e,"tus: invalid or missing Location header")}else r._emitHttpError(a,e,"tus: unexpected response while creating upload")})).catch((function(e){r._emitError(e)}))}},{key:"_startSingleUpload",value:function(){return this._aborted=!1,null!=this.url?("Resuming upload from previous URL: ".concat(this.url),void this._resumeUpload()):null!=this.options.uploadUrl?("Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,void this._resumeUpload()):void this._createUpload()}},{key:"abort",value:function(t){var r=this;return null!=this._parallelUploads&&this._parallelUploads.forEach((function(e){e.abort(t)})),null!==this._req&&this._req.abort(),this._aborted=!0,null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),t&&null!=this.url?e.terminate(this.url,this.options).then((function(){return r._removeFromUrlStorage()})):Promise.resolve()}},{key:"_emitHttpError",value:function(e,t,r,i){this._emitError(new T(r,i,e,t))}},{key:"_emitError",value:function(e){var t=this;if(!this._aborted){if(null!=this.options.retryDelays&&(null!=this._offset&&this._offset>this._offsetBeforeRetry&&(this._retryAttempt=0),B(e,this._retryAttempt,this.options))){var r=this.options.retryDelays[this._retryAttempt++];return this._offsetBeforeRetry=this._offset,void(this._retryTimeout=setTimeout((function(){t.start()}),r))}if("function"!=typeof this.options.onError)throw e;this.options.onError(e)}}},{key:"_emitSuccess",value:function(){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(e,t){"function"==typeof this.options.onProgress&&this.options.onProgress(e,t)}},{key:"_emitChunkComplete",value:function(e,t,r){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(e,t,r)}},{key:"_createUpload",value:function(){var e=this;if(this.options.endpoint){var t=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?t.setHeader("Upload-Defer-Length",1):t.setHeader("Upload-Length",this._size);var r,i=q(this.options.metadata);""!==i&&t.setHeader("Upload-Metadata",i),this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,r=this._addChunkToRequest(t)):r=this._sendRequest(t,null),r.then((function(r){if($(r.getStatus(),200)){var i=r.getHeader("Location");if(null!=i){if(e.url=H(e.options.endpoint,i),"Created upload at ".concat(e.url),"function"==typeof e.options.onUploadUrlAvailable&&e.options.onUploadUrlAvailable(),0===e._size)return e._emitSuccess(),void e._source.close();e._saveUploadInUrlStorage().then((function(){e.options.uploadDataDuringCreation?e._handleUploadResponse(t,r):(e._offset=0,e._performUpload())}))}else e._emitHttpError(t,r,"tus: invalid or missing Location header")}else e._emitHttpError(t,r,"tus: unexpected response while creating upload")})).catch((function(r){e._emitHttpError(t,null,"tus: failed to create upload",r)}))}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var e=this,t=this._openRequest("HEAD",this.url);this._sendRequest(t,null).then((function(r){var i=r.getStatus();if(!$(i,200))return 423===i?void e._emitHttpError(t,r,"tus: upload is currently locked; retry later"):($(i,400)&&e._removeFromUrlStorage(),e.options.endpoint?(e.url=null,void e._createUpload()):void e._emitHttpError(t,r,"tus: unable to resume upload (new upload cannot be created without an endpoint)"));var n=parseInt(r.getHeader("Upload-Offset"),10);if(Number.isNaN(n))e._emitHttpError(t,r,"tus: invalid or missing offset value");else{var s=parseInt(r.getHeader("Upload-Length"),10);!Number.isNaN(s)||e.options.uploadLengthDeferred?("function"==typeof e.options.onUploadUrlAvailable&&e.options.onUploadUrlAvailable(),e._saveUploadInUrlStorage().then((function(){if(n===s)return e._emitProgress(s,s),void e._emitSuccess();e._offset=n,e._performUpload()}))):e._emitHttpError(t,r,"tus: invalid or missing length value")}})).catch((function(r){e._emitHttpError(t,null,"tus: failed to resume upload",r)}))}},{key:"_performUpload",value:function(){var e,t=this;this._aborted||(this.options.overridePatchMethod?(e=this._openRequest("POST",this.url)).setHeader("X-HTTP-Method-Override","PATCH"):e=this._openRequest("PATCH",this.url),e.setHeader("Upload-Offset",this._offset),this._addChunkToRequest(e).then((function(r){$(r.getStatus(),200)?t._handleUploadResponse(e,r):t._emitHttpError(e,r,"tus: unexpected response while uploading chunk")})).catch((function(r){t._aborted||t._emitHttpError(e,null,"tus: failed to upload chunk at offset ".concat(t._offset),r)})))}},{key:"_addChunkToRequest",value:function(e){var t=this,r=this._offset,i=this._offset+this.options.chunkSize;return e.setProgressHandler((function(e){t._emitProgress(r+e,t._size)})),e.setHeader("Content-Type","application/offset+octet-stream"),(i===1/0||i>this._size)&&!this.options.uploadLengthDeferred&&(i=this._size),this._source.slice(r,i).then((function(r){var i=r.value,n=r.done;return t.options.uploadLengthDeferred&&n&&(t._size=t._offset+(i&&i.size?i.size:0),e.setHeader("Upload-Length",t._size)),null===i?t._sendRequest(e):(t._emitProgress(t._offset,t._size),t._sendRequest(e,i))}))}},{key:"_handleUploadResponse",value:function(e,t){var r=parseInt(t.getHeader("Upload-Offset"),10);if(Number.isNaN(r))this._emitHttpError(e,t,"tus: invalid or missing offset value");else{if(this._emitProgress(r,this._size),this._emitChunkComplete(r-this._offset,r,this._size),this._offset=r,r===this._size)return this._emitSuccess(),void this._source.close();this._performUpload()}}},{key:"_openRequest",value:function(e,t){var r=z(e,t,this.options);return this._req=r,r}},{key:"_removeFromUrlStorage",value:function(){var e=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch((function(t){e._emitError(t)})),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var e=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||null!==this._urlStorageKey)return Promise.resolve();var t={size:this._size,metadata:this.options.metadata,creationTime:(new Date).toString()};return this._parallelUploads?t.parallelUploadUrls=this._parallelUploadUrls:t.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,t).then((function(t){e._urlStorageKey=t}))}},{key:"_sendRequest",value:function(e){return M(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,this.options)}}],i=[{key:"terminate",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=z("DELETE",t,r);return M(i,null,r).then((function(e){if(204!==e.getStatus())throw new T("tus: unexpected response while terminating upload",null,i,e)})).catch((function(n){if(n instanceof T||(n=new T("tus: failed to terminate upload",n,i,null)),!B(n,0,r))throw n;var s=r.retryDelays[0],o=r.retryDelays.slice(1),a=C(C({},r),{},{retryDelays:o});return new Promise((function(e){return setTimeout(e,s)})).then((function(){return e.terminate(t,a)}))}))}}],r&&I(t.prototype,r),i&&I(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function q(e){return Object.entries(e).map((function(e){var t=F(e,2),r=t[0],i=t[1];return"".concat(r," ").concat(v(String(i)))})).join(",")}function $(e,t){return e>=t&&e<t+100}function z(e,t,r){var i=r.httpStack.createRequest(e,t);i.setHeader("Tus-Resumable","1.0.0");var n=r.headers||{};if(Object.entries(n).forEach((function(e){var t=F(e,2),r=t[0],n=t[1];i.setHeader(r,n)})),r.addRequestId){var s="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));i.setHeader("X-Request-ID",s)}return i}function M(e,t,r){return("function"==typeof r.onBeforeRequest?Promise.resolve(r.onBeforeRequest(e)):Promise.resolve()).then((function(){return e.send(t).then((function(t){return("function"==typeof r.onAfterResponse?Promise.resolve(r.onAfterResponse(e,t)):Promise.resolve()).then((function(){return t}))}))}))}function B(e,t,r){if(null==r.retryDelays||t>=r.retryDelays.length||null==e.originalRequest)return!1;if(r&&"function"==typeof r.onShouldRetry)return r.onShouldRetry(e,t,r);var i,n=e.originalResponse?e.originalResponse.getStatus():0;return(!$(n,400)||409===n||423===n)&&(i=!0,"undefined"!=typeof window&&"navigator"in window&&!1===window.navigator.onLine&&(i=!1),i)}function H(e,t){return new(w())(t,e).toString()}N.defaultOptions=L;var V=N;function K(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var X=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,(r=[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(e){return Promise.resolve([])}},{key:"removeUpload",value:function(e){return Promise.resolve()}},{key:"addUpload",value:function(e,t){return Promise.resolve(null)}}])&&K(t.prototype,r),i&&K(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function G(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var W=!1;try{W="localStorage"in window;var Z="tusSupport",Y=localStorage.getItem(Z);localStorage.setItem(Z,Y),null===Y&&localStorage.removeItem(Z)}catch(e){if(e.code!==e.SECURITY_ERR&&e.code!==e.QUOTA_EXCEEDED_ERR)throw e;W=!1}var J=W,Q=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,r=[{key:"findAllUploads",value:function(){var e=this._findEntries("tus::");return Promise.resolve(e)}},{key:"findUploadsByFingerprint",value:function(e){var t=this._findEntries("tus::".concat(e,"::"));return Promise.resolve(t)}},{key:"removeUpload",value:function(e){return localStorage.removeItem(e),Promise.resolve()}},{key:"addUpload",value:function(e,t){var r=Math.round(1e12*Math.random()),i="tus::".concat(e,"::").concat(r);return localStorage.setItem(i,JSON.stringify(t)),Promise.resolve(i)}},{key:"_findEntries",value:function(e){for(var t=[],r=0;r<localStorage.length;r++){var i=localStorage.key(r);if(0===i.indexOf(e))try{var n=JSON.parse(localStorage.getItem(i));n.urlStorageKey=i,t.push(n)}catch(e){}}return t}}],r&&G(t.prototype,r),i&&G(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function te(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function re(e,t,r){return t&&te(e.prototype,t),r&&te(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ie=function(){function e(){ee(this,e)}return re(e,[{key:"createRequest",value:function(e,t){return new ne(e,t)}},{key:"getName",value:function(){return"XHRHttpStack"}}]),e}(),ne=function(){function e(t,r){ee(this,e),this._xhr=new XMLHttpRequest,this._xhr.open(t,r,!0),this._method=t,this._url=r,this._headers={}}return re(e,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(e,t){this._xhr.setRequestHeader(e,t),this._headers[e]=t}},{key:"getHeader",value:function(e){return this._headers[e]}},{key:"setProgressHandler",value:function(e){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(t){t.lengthComputable&&e(t.loaded)})}},{key:"send",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(r,i){e._xhr.onload=function(){r(new se(e._xhr))},e._xhr.onerror=function(e){i(e)},e._xhr.send(t)}))}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}(),se=function(){function e(t){ee(this,e),this._xhr=t}return re(e,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(e){return this._xhr.getResponseHeader(e)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}(),oe=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()};var ae=function(){return"undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova)};function le(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ue=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._file=t,this.size=t.size}var t,r,i;return t=e,(r=[{key:"slice",value:function(e,t){if(ae())return r=this._file.slice(e,t),new Promise((function(e,t){var i=new FileReader;i.onload=function(){var t=new Uint8Array(i.result);e({value:t})},i.onerror=function(e){t(e)},i.readAsArrayBuffer(r)}));var r,i=this._file.slice(e,t);return Promise.resolve({value:i})}},{key:"close",value:function(){}}])&&le(t.prototype,r),i&&le(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function he(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ce(e){return void 0===e?0:void 0!==e.size?e.size:e.length}var pe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._buffer=void 0,this._bufferOffset=0,this._reader=t,this._done=!1}var t,r,i;return t=e,(r=[{key:"slice",value:function(e,t){return e<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(e,t)}},{key:"_readUntilEnoughDataOrDone",value:function(e,t){var r=this,i=t<=this._bufferOffset+ce(this._buffer);if(this._done||i){var n=this._getDataFromBuffer(e,t),s=null==n&&this._done;return Promise.resolve({value:n,done:s})}return this._reader.read().then((function(i){var n=i.value;return i.done?r._done=!0:void 0===r._buffer?r._buffer=n:r._buffer=function(e,t){if(e.concat)return e.concat(t);if(e instanceof Blob)return new Blob([e,t],{type:e.type});if(e.set){var r=new e.constructor(e.length+t.length);return r.set(e),r.set(t,e.length),r}throw new Error("Unknown data type")}(r._buffer,n),r._readUntilEnoughDataOrDone(e,t)}))}},{key:"_getDataFromBuffer",value:function(e,t){e>this._bufferOffset&&(this._buffer=this._buffer.slice(e-this._bufferOffset),this._bufferOffset=e);var r=0===ce(this._buffer);return this._done&&r?null:this._buffer.slice(0,t-e)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])&&he(t.prototype,r),i&&he(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function de(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,(r=[{key:"openFile",value:function(e,t){return oe()&&e&&void 0!==e.uri?(r=e.uri,new Promise((function(e,t){var i=new XMLHttpRequest;i.responseType="blob",i.onload=function(){var t=i.response;e(t)},i.onerror=function(e){t(e)},i.open("GET",r),i.send()}))).then((function(e){return new ue(e)})).catch((function(e){throw new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(e))})):"function"==typeof e.slice&&void 0!==e.size?Promise.resolve(new ue(e)):"function"==typeof e.read?(t=Number(t),Number.isFinite(t)?Promise.resolve(new pe(e,t)):Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option"))):Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment"));var r}}])&&de(t.prototype,r),i&&de(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ge(e){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(e)}function me(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ye(e,t){return ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ye(e,t)}function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=be(e);if(t){var n=be(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===ge(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function be(e){return be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},be(e)}function we(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(Object(r),!0).forEach((function(t){Se(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):we(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Pe=Oe(Oe({},V.defaultOptions),{},{httpStack:new ie,fileReader:new fe,urlStorage:J?new Q:new X,fingerprint:function(e,t){return oe()?Promise.resolve(function(e,t){var r=e.exif?function(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t&=t}return t}(JSON.stringify(e.exif)):"noexif";return["tus-rn",e.name||"noname",e.size||"nosize",r,t.endpoint].join("/")}(e,t)):Promise.resolve(["tus-br",e.name,e.type,e.size,e.lastModified,t.endpoint].join("-"))}}),_e=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ye(e,t)}(s,e);var t,r,i,n=ve(s);function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=Oe(Oe({},Pe),t),n.call(this,e,t)}return t=s,i=[{key:"terminate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=Oe(Oe({},Pe),t),V.terminate(e,t)}}],(r=null)&&me(t.prototype,r),i&&me(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(V),ke=window,Ue=ke.XMLHttpRequest,Ee=ke.Blob,xe=(Ue&&Ee&&Ee.prototype.slice,r(9537));var je=r(3493)((function(e,t,r){const{progress:i,bytesUploaded:n,bytesTotal:s}=t;i&&(e.uppy.log(`Upload progress: ${i}`),e.uppy.emit("upload-progress",r,{uploader:e,bytesUploaded:n,bytesTotal:s}))}),300,{leading:!0,trailing:!0});function Te(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Fe=0;function Re(e){return"__private_"+Fe+++"_"+e}var Ae=Re("emitter"),Ce=Re("events");class De{constructor(e){Object.defineProperty(this,Ae,{writable:!0,value:void 0}),Object.defineProperty(this,Ce,{writable:!0,value:[]}),Te(this,Ae)[Ae]=e}on(e,t){return Te(this,Ce)[Ce].push([e,t]),Te(this,Ae)[Ae].on(e,t)}remove(){for(const[e,t]of Te(this,Ce)[Ce].splice(0))Te(this,Ae)[Ae].off(e,t)}}class Ie extends Error{constructor(e,t){void 0===t&&(t=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}var Le=Ie;var Ne=function(e){return!!e&&(0!==e.readyState&&4!==e.readyState||0===e.status)};function qe(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var $e=0;function ze(e){return"__private_"+$e+++"_"+e}function Me(e){if(null!=e){var t;const r=()=>this.abort(e.reason);e.addEventListener("abort",r,{once:!0});const i=()=>{e.removeEventListener("abort",r)};null==(t=this.then)||t.call(this,i,i)}return this}var Be=ze("activeRequests"),He=ze("queuedHandlers"),Ve=ze("paused"),Ke=ze("pauseTimer"),Xe=ze("downLimit"),Ge=ze("upperLimit"),We=ze("rateLimitingTimer"),Ze=ze("call"),Ye=ze("queueNext"),Je=ze("next"),Qe=ze("queue"),et=ze("dequeue"),tt=ze("resume"),rt=ze("increaseLimit");class it{constructor(e){Object.defineProperty(this,et,{value:lt}),Object.defineProperty(this,Qe,{value:at}),Object.defineProperty(this,Je,{value:ot}),Object.defineProperty(this,Ye,{value:st}),Object.defineProperty(this,Ze,{value:nt}),Object.defineProperty(this,Be,{writable:!0,value:0}),Object.defineProperty(this,He,{writable:!0,value:[]}),Object.defineProperty(this,Ve,{writable:!0,value:!1}),Object.defineProperty(this,Ke,{writable:!0,value:void 0}),Object.defineProperty(this,Xe,{writable:!0,value:1}),Object.defineProperty(this,Ge,{writable:!0,value:void 0}),Object.defineProperty(this,We,{writable:!0,value:void 0}),Object.defineProperty(this,tt,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,rt,{writable:!0,value:()=>{if(qe(this,Ve)[Ve])qe(this,We)[We]=setTimeout(qe(this,rt)[rt],0);else{qe(this,Xe)[Xe]=this.limit,this.limit=Math.ceil((qe(this,Ge)[Ge]+qe(this,Xe)[Xe])/2);for(let e=qe(this,Xe)[Xe];e<=this.limit;e++)qe(this,Ye)[Ye]();qe(this,Ge)[Ge]-qe(this,Xe)[Xe]>3?qe(this,We)[We]=setTimeout(qe(this,rt)[rt],2e3):qe(this,Xe)[Xe]=Math.floor(qe(this,Xe)[Xe]/2)}}}),this.limit="number"!=typeof e||0===e?1/0:e}run(e,t){return!qe(this,Ve)[Ve]&&qe(this,Be)[Be]<this.limit?qe(this,Ze)[Ze](e):qe(this,Qe)[Qe](e,t)}wrapSyncFunction(e,t){var r=this;return function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];const o=r.run((()=>(e(...n),queueMicrotask((()=>o.done())),()=>{})),t);return{abortOn:Me,abort(){o.abort()}}}}wrapPromiseFunction(e,t){var r=this;return function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];let o;const a=new Promise(((i,s)=>{o=r.run((()=>{let t,r;try{r=Promise.resolve(e(...n))}catch(e){r=Promise.reject(e)}return r.then((e=>{t?s(t):(o.done(),i(e))}),(e=>{t?s(t):(o.done(),s(e))})),e=>{t=function(e){return new Error("Cancelled",{cause:e})}(e)}}),t)}));return a.abort=e=>{o.abort(e)},a.abortOn=Me,a}}resume(){qe(this,Ve)[Ve]=!1,clearTimeout(qe(this,Ke)[Ke]);for(let e=0;e<this.limit;e++)qe(this,Ye)[Ye]()}pause(e){void 0===e&&(e=null),qe(this,Ve)[Ve]=!0,clearTimeout(qe(this,Ke)[Ke]),null!=e&&(qe(this,Ke)[Ke]=setTimeout(qe(this,tt)[tt],e))}rateLimit(e){clearTimeout(qe(this,We)[We]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(qe(this,Ge)[Ge]=this.limit-1,this.limit=qe(this,Xe)[Xe],qe(this,We)[We]=setTimeout(qe(this,rt)[rt],e))}get isPaused(){return qe(this,Ve)[Ve]}}function nt(e){qe(this,Be)[Be]+=1;let t,r=!1;try{t=e()}catch(e){throw qe(this,Be)[Be]-=1,e}return{abort:e=>{r||(r=!0,qe(this,Be)[Be]-=1,t(e),qe(this,Ye)[Ye]())},done:()=>{r||(r=!0,qe(this,Be)[Be]-=1,qe(this,Ye)[Ye]())}}}function st(){queueMicrotask((()=>qe(this,Je)[Je]()))}function ot(){if(qe(this,Ve)[Ve]||qe(this,Be)[Be]>=this.limit)return;if(0===qe(this,He)[He].length)return;const e=qe(this,He)[He].shift(),t=qe(this,Ze)[Ze](e.fn);e.abort=t.abort,e.done=t.done}function at(e,t){void 0===t&&(t={});const r={fn:e,priority:t.priority||0,abort:()=>{qe(this,et)[et](r)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},i=qe(this,He)[He].findIndex((e=>r.priority>e.priority));return-1===i?qe(this,He)[He].push(r):qe(this,He)[He].splice(i,0,r),r}function lt(e){const t=qe(this,He)[He].indexOf(e);-1!==t&&qe(this,He)[He].splice(t,1)}Symbol("__queue");function ut(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ht(e){return(t,r)=>{if("undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova)||"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase())return Pe.fingerprint(t,r);const i=["tus",e.id,r.endpoint].join("-");return Promise.resolve(i)}}function ct(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var pt=0;function dt(e){return"__private_"+pt+++"_"+e}const ft={endpoint:"",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[100,1e3,3e3,5e3],parallelUploads:1,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1};var gt=dt("retryDelayIterator"),mt=dt("upload"),yt=dt("requestSocketToken"),vt=dt("uploadFiles"),bt=dt("handleUpload");class wt extends i.Z{constructor(e,t){var r,i;super(e,t),Object.defineProperty(this,vt,{value:St}),Object.defineProperty(this,mt,{value:Ot}),Object.defineProperty(this,gt,{writable:!0,value:void 0}),Object.defineProperty(this,yt,{writable:!0,value:async(e,t)=>{const r=new(e.remote.providerOptions.provider?xe.zt:xe.C$)(this.uppy,e.remote.providerOptions),i={...this.opts};e.tus&&Object.assign(i,e.tus);return(await r.post(e.remote.url,{...e.remote.body,endpoint:i.endpoint,uploadUrl:i.uploadUrl,protocol:"tus",size:e.data.size,headers:i.headers,metadata:e.meta},t)).token}}),Object.defineProperty(this,bt,{writable:!0,value:async e=>{if(0===e.length)return void this.uppy.log("[Tus] No files to upload");0===this.opts.limit&&this.uppy.log("[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0","warning"),this.uppy.log("[Tus] Uploading...");const t=this.uppy.getFilesByIds(e);await ct(this,vt)[vt](t)}}),this.type="uploader",this.id=this.opts.id||"Tus",this.title="Tus";const n={useFastRemoteRetry:!0,limit:20,retryDelays:ft.retryDelays,withCredentials:!1};if(this.opts={...n,...t},void 0===(null==t?void 0:t.allowedMetaFields)&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");if("autoRetry"in t)throw new Error("The `autoRetry` option was deprecated and has been removed.");this.requests=null!=(r=this.opts.rateLimitedQueue)?r:new it(this.opts.limit),ct(this,gt)[gt]=null==(i=this.opts.retryDelays)?void 0:i.values(),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null),this.uploaderSockets=Object.create(null),this.handleResetProgress=this.handleResetProgress.bind(this),this.setQueueRequestSocketToken(this.requests.wrapPromiseFunction(ct(this,yt)[yt],{priority:-1}))}handleResetProgress(){const e={...this.uppy.getState().files};Object.keys(e).forEach((t=>{if(e[t].tus&&e[t].tus.uploadUrl){const r={...e[t].tus};delete r.uploadUrl,e[t]={...e[t],tus:r}}})),this.uppy.setState({files:e})}resetUploaderReferences(e,t){if(void 0===t&&(t={}),this.uploaders[e]){const r=this.uploaders[e];r.abort(),t.abort&&r.abort(!0),this.uploaders[e]=null}this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null),this.uploaderSockets[e]&&(this.uploaderSockets[e].close(),this.uploaderSockets[e]=null)}async connectToServerSocket(e){var t=this;return new Promise(((r,i)=>{const n=e.serverToken,s=function(e){const t=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i.exec(e)[1];return`${/^http:\/\//i.test(e)?"ws":"wss"}://${t}`}(e.remote.companionUrl),o=new xe.sk({target:`${s}/api/${n}`,autoOpen:!1});let a;this.uploaderSockets[e.id]=o,this.uploaderEvents[e.id]=new De(this.uppy),this.onFileRemove(e.id,(()=>{o.send("cancel",{}),a.abort(),this.resetUploaderReferences(e.id),r(`upload ${e.id} was removed`)})),this.onPause(e.id,(e=>{e?(o.send("pause",{}),a.abort()):(a.abort(),a=this.requests.run((()=>(o.open(),o.send("resume",{}),()=>{}))))})),this.onPauseAll(e.id,(()=>{o.send("pause",{}),a.abort()})),this.onCancelAll(e.id,(function(i){let{reason:n}=void 0===i?{}:i;"user"===n&&(o.send("cancel",{}),a.abort(),t.resetUploaderReferences(e.id)),r(`upload ${e.id} was canceled`)})),this.onResumeAll(e.id,(()=>{a.abort(),e.error&&o.send("pause",{}),a=this.requests.run((()=>(o.open(),o.send("resume",{}),()=>{})))})),this.onRetry(e.id,(()=>{o.isOpen&&(o.send("pause",{}),o.send("resume",{}))})),this.onRetryAll(e.id,(()=>{o.isOpen&&(o.send("pause",{}),o.send("resume",{}))})),o.on("progress",(t=>je(this,t,e))),o.on("error",(t=>{const{message:r}=t.error,n=Object.assign(new Error(r),{cause:t.error});this.opts.useFastRemoteRetry?o.close():(this.resetUploaderReferences(e.id),this.uppy.setFileState(e.id,{serverToken:null})),this.uppy.emit("upload-error",e,n),a.done(),i(n)})),o.on("success",(t=>{const i={uploadURL:t.url};this.uppy.emit("upload-success",e,i),this.resetUploaderReferences(e.id),a.done(),o.close(),r()})),a=this.requests.run((()=>(e.isPaused?o.send("pause",{}):o.open(),()=>{})))}))}onReceiveUploadUrl(e,t){const r=this.uppy.getFile(e.id);r&&(r.tus&&r.tus.uploadUrl===t||(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(r.id,{tus:{...r.tus,uploadUrl:t}})))}onFileRemove(e,t){this.uploaderEvents[e].on("file-removed",(r=>{e===r.id&&t(r.id)}))}onPause(e,t){this.uploaderEvents[e].on("upload-pause",((r,i)=>{e===r&&t(i)}))}onRetry(e,t){this.uploaderEvents[e].on("upload-retry",(r=>{e===r&&t()}))}onRetryAll(e,t){this.uploaderEvents[e].on("retry-all",(()=>{this.uppy.getFile(e)&&t()}))}onPauseAll(e,t){this.uploaderEvents[e].on("pause-all",(()=>{this.uppy.getFile(e)&&t()}))}onCancelAll(e,t){var r=this;this.uploaderEvents[e].on("cancel-all",(function(){r.uppy.getFile(e)&&t(...arguments)}))}onResumeAll(e,t){this.uploaderEvents[e].on("resume-all",(()=>{this.uppy.getFile(e)&&t()}))}install(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!0}}),this.uppy.addUploader(ct(this,bt)[bt]),this.uppy.on("reset-progress",this.handleResetProgress)}uninstall(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!1}}),this.uppy.removeUploader(ct(this,bt)[bt])}}function Ot(e){var t=this;return this.resetUploaderReferences(e.id),new Promise(((r,i)=>{let n,s,o;const a={...this.opts,...e.tus||{}};"function"==typeof a.headers&&(a.headers=a.headers(e));const l={...ft,...a};l.fingerprint=ht(e),l.onBeforeRequest=t=>{let r;if(t.getUnderlyingObject().withCredentials=!!a.withCredentials,"function"==typeof a.onBeforeRequest&&(r=a.onBeforeRequest(t,e)),ut(n,"shouldBeRequeued")){if(!n.shouldBeRequeued)return Promise.reject();let t;const i=new Promise((e=>{t=e}));return n=this.requests.run((()=>(e.isPaused&&n.abort(),t(),()=>{}))),Promise.all([i,r])}return r},l.onError=t=>{var r;this.uppy.log(t);const s=t.originalRequest?t.originalRequest.getUnderlyingObject():null;Ne(s)&&(t=new Le(t,s)),this.resetUploaderReferences(e.id),null==(r=n)||r.abort(),this.uppy.emit("upload-error",e,t),i(t)},l.onProgress=(t,r)=>{this.onReceiveUploadUrl(e,o.url),this.uppy.emit("upload-progress",e,{uploader:this,bytesUploaded:t,bytesTotal:r})},l.onSuccess=()=>{const t={uploadURL:o.url};this.resetUploaderReferences(e.id),n.done(),this.uppy.emit("upload-success",e,t),o.url&&this.uppy.log(`Download ${o.file.name} from ${o.url}`),r(o)};const u=e=>{var t;const r=null==e||null==(t=e.originalResponse)?void 0:t.getStatus();if(429===r){if(!this.requests.isPaused){var i;const e=null==(i=ct(this,gt)[gt])?void 0:i.next();if(null==e||e.done)return!1;this.requests.rateLimit(e.value)}}else{if(r>400&&r<500&&409!==r&&423!==r)return!1;"undefined"!=typeof navigator&&!1===navigator.onLine&&(this.requests.isPaused||(this.requests.pause(),window.addEventListener("online",(()=>{this.requests.resume()}),{once:!0})))}return n.abort(),n={shouldBeRequeued:!0,abort(){this.shouldBeRequeued=!1},done(){throw new Error("Cannot mark a queued request as done: this indicates a bug")},fn(){throw new Error("Cannot run a queued request: this indicates a bug")}},!0};null!=a.onShouldRetry?l.onShouldRetry=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return a.onShouldRetry(...t,u)}:l.onShouldRetry=u;const h=(e,t,r)=>{ut(e,t)&&!ut(e,r)&&(e[r]=e[t])},c={};(Array.isArray(a.allowedMetaFields)?a.allowedMetaFields:Object.keys(e.meta)).forEach((t=>{c[t]=e.meta[t]})),h(c,"type","filetype"),h(c,"name","filename"),l.metadata=c,o=new _e(e.data,l),this.uploaders[e.id]=o,this.uploaderEvents[e.id]=new De(this.uppy),s=()=>(e.isPaused||o.start(),()=>{}),o.findPreviousUploads().then((t=>{const r=t[0];r&&(this.uppy.log(`[Tus] Resuming upload of ${e.id} started at ${r.creationTime}`),o.resumeFromPreviousUpload(r))})),n=this.requests.run(s),this.onFileRemove(e.id,(t=>{n.abort(),this.resetUploaderReferences(e.id,{abort:!!o.url}),r(`upload ${t} was removed`)})),this.onPause(e.id,(e=>{n.abort(),e?o.abort():n=this.requests.run(s)})),this.onPauseAll(e.id,(()=>{n.abort(),o.abort()})),this.onCancelAll(e.id,(function(i){let{reason:s}=void 0===i?{}:i;"user"===s&&(n.abort(),t.resetUploaderReferences(e.id,{abort:!!o.url})),r(`upload ${e.id} was canceled`)})),this.onResumeAll(e.id,(()=>{n.abort(),e.error&&o.abort(),n=this.requests.run(s)}))})).catch((t=>{throw this.uppy.emit("upload-error",e,t),t}))}async function St(e){const t=function(e){return e.filter((e=>!(e=>"error"in e&&e.error)(e)))}(e),r=function(e){return e.filter((e=>!e.progress.uploadStarted||!e.isRestored))}(t);this.uppy.emit("upload-start",r),await Promise.allSettled(t.map(((t,r)=>{const i=r+1,n=e.length;if(t.isRemote){const e=new AbortController,r=r=>{r.id===t.id&&e.abort()};this.uppy.on("file-removed",r),this.resetUploaderReferences(t.id);const i=this.uploadRemoteFile(t,{signal:e.signal});return this.requests.wrapSyncFunction((()=>{this.uppy.off("file-removed",r)}),{priority:-1})(),i}return ct(this,mt)[mt](t,i,n)})))}wt.VERSION="3.1.2"},6594:function(e,t,r){"use strict";function i(e,t,r,n){let{onSuccess:s}=n;e.readEntries((n=>{const o=[...t,...n];n.length?queueMicrotask((()=>{i(e,o,r,{onSuccess:s})})):s(o)}),(e=>{r(e),s(t)}))}function n(e,t){return null==e?e:{kind:e.isFile?"file":e.isDirectory?"directory":void 0,name:e.name,getFile(){return new Promise(((t,r)=>e.file(t,r)))},async*values(){const r=e.createReader(),s=await new Promise((e=>{i(r,[],t,{onSuccess:r=>e(r.map((e=>n(e,t))))})}));yield*s}}}async function*s(e,t,r){if(void 0===r&&(r=void 0),"file"===e.kind){const i=await e.getFile();null!=i?(i.relativePath=t?`${t}/${e.name}`:null,yield i):null!=r&&(yield r)}else if("directory"===e.kind)for await(const r of e.values())yield*s(r,`${t}/${e.name}`);else null!=r&&(yield r)}r.d(t,{Z:function(){return a}});var o=r(7581);async function a(e,t){let{logDropError:r=(()=>{})}=void 0===t?{}:t;try{const t=[];for await(const i of async function*(e,t){const r=await Promise.all(Array.from(e.items,(async e=>{let r;return null!=r||(r=n("function"==typeof e.getAsEntry?e.getAsEntry():e.webkitGetAsEntry(),t)),{fileSystemHandle:r,lastResortFile:e.getAsFile()}})));for(const{lastResortFile:e,fileSystemHandle:i}of r)if(null!=i)try{yield*s(i,"",e)}catch(r){null!=e?yield e:t(r)}else null!=e&&(yield e)}(e,r))t.push(i);return t}catch{return function(e){const t=(0,o.Z)(e.files);return Promise.resolve(t)}(e)}}},8215:function(e,t,r){"use strict";function i(){const e=document.body;return"draggable"in e&&"ondragstart"in e&&"ondrop"in e&&("FormData"in window&&"FileReader"in window)}r.d(t,{Z:function(){return i}})},7581:function(e,t){"use strict";t.Z=Array.from},1653:function(e,t,r){"use strict";r.d(t,{Z:function(){return qe}});var i={};r.r(i),r.d(i,{getItem:function(){return _},removeItem:function(){return k},setItem:function(){return P}});var n=r(8596),s=r(9022);class o extends Error{constructor(e,t){void 0===t&&(t=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}var a=o;class l extends Error{constructor(e,t){var r,i;void 0===t&&(t={}),super(e),this.cause=t.cause,this.cause&&(r=this.cause,i="isNetworkError",Object.prototype.hasOwnProperty.call(r,i))&&(this.isNetworkError=this.cause.isNetworkError)}}var u=l;class h extends Error{constructor(){super("Authorization required"),this.name="AuthError",this.isAuthError=!0}}var c=h;let p;function d(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var f=0;function g(e){return"__private_"+f+++"_"+e}const m=new Map;var y=g("companionHeaders"),v=g("getUrl"),b=g("request");p=Symbol.for("uppy test: getCompanionHeaders");class w{constructor(e,t){Object.defineProperty(this,b,{value:S}),Object.defineProperty(this,v,{value:O}),Object.defineProperty(this,y,{writable:!0,value:void 0}),this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),d(this,y)[y]=null==t?void 0:t.companionHeaders}setCompanionHeaders(e){d(this,y)[y]=e}[p](){return d(this,y)[y]}get hostname(){const{companion:e}=this.uppy.getState(),t=this.opts.companionUrl;return(e&&e[t]?e[t]:t).replace(/\/$/,"")}async headers(){return{...{Accept:"application/json","Content-Type":"application/json","Uppy-Versions":`@uppy/companion-client=${w.VERSION}`},...d(this,y)[y]}}onReceiveResponse(e){let{headers:t}=e;const r=this.uppy.getState().companion||{},i=this.opts.companionUrl;t.has("i-am")&&t.get("i-am")!==r[i]&&this.uppy.setState({companion:{...r,[i]:t.get("i-am")}})}async preflight(e){const t=m.get(this.hostname);if(null!=t)return t;const r=["accept","content-type","uppy-auth-token"],i=(async()=>{try{const t=(await fetch(d(this,v)[v](e),{method:"OPTIONS"})).headers.get("access-control-allow-headers");if(null==t||"*"===t)return m.set(this.hostname,r),r;this.uppy.log(`[CompanionClient] adding allowed preflight headers to companion cache: ${this.hostname} ${t}`);const i=t.split(",").map((e=>e.trim().toLowerCase()));return m.set(this.hostname,i),i}catch(e){return this.uppy.log(`[CompanionClient] unable to make preflight request ${e}`,"warning"),m.delete(this.hostname),r}})();return m.set(this.hostname,i),i}async preflightAndHeaders(e){const[t,r]=await Promise.all([this.preflight(e),this.headers()]);return Object.fromEntries(Object.entries(r).filter((e=>{let[r]=e;return!!t.includes(r.toLowerCase())||(this.uppy.log(`[CompanionClient] excluding disallowed header ${r}`),!1)})))}async get(e,t){return void 0===t&&(t=void 0),"boolean"==typeof t&&(t={skipPostResponse:t}),d(this,b)[b]({...t,path:e})}async post(e,t,r){return void 0===r&&(r=void 0),"boolean"==typeof r&&(r={skipPostResponse:r}),d(this,b)[b]({...r,path:e,method:"POST",data:t})}async delete(e,t,r){return void 0===t&&(t=void 0),"boolean"==typeof r&&(r={skipPostResponse:r}),d(this,b)[b]({...r,path:e,method:"DELETE",data:t})}}function O(e){return/^(https?:|)\/\//.test(e)?e:`${this.hostname}/${e}`}async function S(e){let{path:t,method:r="GET",data:i,skipPostResponse:n,signal:s}=e;try{const e=await this.preflightAndHeaders(t),o=await function(){return fetch(...arguments).catch((e=>{throw"AbortError"===e.name?e:new a(e)}))}(d(this,v)[v](t),{method:r,signal:s,headers:e,credentials:this.opts.companionCookiesRule||"same-origin",body:i?JSON.stringify(i):null});return n||this.onReceiveResponse(o),async function(e){if(401===e.status)throw new c;const t=e.json();if(e.ok)return t;let r=`Failed request with status: ${e.status}. ${e.statusText}`;try{const e=await t;r=e.message?`${r} message: ${e.message}`:r,r=e.requestId?`${r} request-Id: ${e.requestId}`:r}catch{}throw new Error(r)}(o)}catch(e){if(null!=e&&e.isAuthError)throw e;throw new u(`Could not ${r} ${d(this,v)[v](t)}`,{cause:e})}}function P(e,t){return new Promise((r=>{localStorage.setItem(e,t),r()}))}function _(e){return Promise.resolve(localStorage.getItem(e))}function k(e){return new Promise((t=>{localStorage.removeItem(e),t()}))}w.VERSION="3.1.3";class U extends w{constructor(e,t){super(e,t),this.provider=t.provider,this.id=this.provider,this.name=this.opts.name||(e=>e.split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "))(this.id),this.pluginId=this.opts.pluginId,this.tokenKey=`companion-${this.pluginId}-auth-token`,this.companionKeysParams=this.opts.companionKeysParams,this.preAuthToken=null}async headers(){const[e,t]=await Promise.all([super.headers(),this.getAuthToken()]),r={};return t&&(r["uppy-auth-token"]=t),this.companionKeysParams&&(r["uppy-credentials-params"]=btoa(JSON.stringify({params:this.companionKeysParams}))),{...e,...r}}onReceiveResponse(e){super.onReceiveResponse(e);const t=this.uppy.getPlugin(this.pluginId),r=t.getPluginState().authenticated?401!==e.status:e.status<400;return t.setPluginState({authenticated:r}),e}setAuthToken(e){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,e)}getAuthToken(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)}async ensurePreAuth(){if(this.companionKeysParams&&!this.preAuthToken&&(await this.fetchPreAuthToken(),!this.preAuthToken))throw new Error("Could not load authentication data required for third-party login. Please try again later.")}authUrl(e){void 0===e&&(e={});const t=new URLSearchParams(e);return this.preAuthToken&&t.set("uppyPreAuthToken",this.preAuthToken),`${this.hostname}/${this.id}/connect?${t}`}fileUrl(e){return`${this.hostname}/${this.id}/get/${e}`}async fetchPreAuthToken(){if(this.companionKeysParams)try{const e=await this.post(`${this.id}/preauth/`,{params:this.companionKeysParams});this.preAuthToken=e.token}catch(e){this.uppy.log(`[CompanionClient] unable to fetch preAuthToken ${e}`,"warning")}}list(e){return this.get(`${this.id}/list/${e||""}`)}logout(){return this.get(`${this.id}/logout`).then((e=>Promise.all([e,this.uppy.getPlugin(this.pluginId).storage.removeItem(this.tokenKey)]))).then((e=>{let[t]=e;return t}))}static initPlugin(e,t,r){if(e.type="acquirer",e.files=[],r&&(e.opts={...r,...t}),t.serverUrl||t.serverPattern)throw new Error("`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`");if(t.companionAllowedHosts){const r=t.companionAllowedHosts;if(!("string"==typeof r||Array.isArray(r)||r instanceof RegExp))throw new TypeError(`${e.id}: the option "companionAllowedHosts" must be one of string, Array, RegExp`);e.opts.companionAllowedHosts=r}else/^(?!https?:\/\/).*$/i.test(t.companionUrl)?e.opts.companionAllowedHosts=`https://${t.companionUrl.replace(/^\/\//,"")}`:e.opts.companionAllowedHosts=new URL(t.companionUrl).origin;e.storage=e.opts.storage||i}}var E=r(4800);let x,j;function T(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var F=0;function R(e){return"__private_"+F+++"_"+e}var A=R("queued"),C=R("emitter"),D=R("isOpen"),I=R("socket"),L=R("handleMessage");x=Symbol.for("uppy test: getSocket"),j=Symbol.for("uppy test: getQueued");class N{constructor(e){Object.defineProperty(this,A,{writable:!0,value:[]}),Object.defineProperty(this,C,{writable:!0,value:E()}),Object.defineProperty(this,D,{writable:!0,value:!1}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:e=>{try{const t=JSON.parse(e.data);this.emit(t.action,t.payload)}catch(e){}}}),this.opts=e,e&&!1===e.autoOpen||this.open()}get isOpen(){return T(this,D)[D]}[x](){return T(this,I)[I]}[j](){return T(this,A)[A]}open(){null==T(this,I)[I]&&(T(this,I)[I]=new WebSocket(this.opts.target),T(this,I)[I].onopen=()=>{for(T(this,D)[D]=!0;T(this,A)[A].length>0&&T(this,D)[D];){const e=T(this,A)[A].shift();this.send(e.action,e.payload)}},T(this,I)[I].onclose=()=>{T(this,D)[D]=!1,T(this,I)[I]=null},T(this,I)[I].onmessage=T(this,L)[L])}close(){var e;null==(e=T(this,I)[I])||e.close()}send(e,t){T(this,D)[D]?T(this,I)[I].send(JSON.stringify({action:e,payload:t})):T(this,A)[A].push({action:e,payload:t})}on(e,t){T(this,C)[C].on(e,t)}emit(e,t){T(this,C)[C].emit(e,t)}once(e,t){T(this,C)[C].once(e,t)}}var q=r(3096)((function(e,t,r){const{progress:i,bytesUploaded:n,bytesTotal:s}=t;i&&(e.uppy.log(`Upload progress: ${i}`),e.uppy.emit("upload-progress",r,{uploader:e,bytesUploaded:n,bytesTotal:s}))}),300,{leading:!0,trailing:!0});function $(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var z=0;function M(e){return"__private_"+z+++"_"+e}var B=M("emitter"),H=M("events");class V{constructor(e){Object.defineProperty(this,B,{writable:!0,value:void 0}),Object.defineProperty(this,H,{writable:!0,value:[]}),$(this,B)[B]=e}on(e,t){return $(this,H)[H].push([e,t]),$(this,B)[B].on(e,t)}remove(){for(const[e,t]of $(this,H)[H].splice(0))$(this,B)[B].off(e,t)}}function K(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var X=0;function G(e){return"__private_"+X+++"_"+e}var W=G("aliveTimer"),Z=G("isDone"),Y=G("onTimedOut"),J=G("timeout");var Q=class{constructor(e,t){Object.defineProperty(this,W,{writable:!0,value:void 0}),Object.defineProperty(this,Z,{writable:!0,value:!1}),Object.defineProperty(this,Y,{writable:!0,value:void 0}),Object.defineProperty(this,J,{writable:!0,value:void 0}),K(this,J)[J]=e,K(this,Y)[Y]=t}progress(){K(this,Z)[Z]||K(this,J)[J]>0&&(clearTimeout(K(this,W)[W]),K(this,W)[W]=setTimeout(K(this,Y)[Y],K(this,J)[J]))}done(){K(this,Z)[Z]||(clearTimeout(K(this,W)[W]),K(this,W)[W]=null,K(this,Z)[Z]=!0)}};function ee(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var te=0;function re(e){return"__private_"+te+++"_"+e}function ie(e){if(null!=e){const t=()=>this.abort(e.reason);e.addEventListener("abort",t,{once:!0});const r=()=>{e.removeEventListener("abort",t)};this.then(r,r)}return this}var ne=re("activeRequests"),se=re("queuedHandlers"),oe=re("paused"),ae=re("pauseTimer"),le=re("downLimit"),ue=re("upperLimit"),he=re("rateLimitingTimer"),ce=re("call"),pe=re("queueNext"),de=re("next"),fe=re("queue"),ge=re("dequeue"),me=re("resume"),ye=re("increaseLimit");class ve{constructor(e){Object.defineProperty(this,ge,{value:Pe}),Object.defineProperty(this,fe,{value:Se}),Object.defineProperty(this,de,{value:Oe}),Object.defineProperty(this,pe,{value:we}),Object.defineProperty(this,ce,{value:be}),Object.defineProperty(this,ne,{writable:!0,value:0}),Object.defineProperty(this,se,{writable:!0,value:[]}),Object.defineProperty(this,oe,{writable:!0,value:!1}),Object.defineProperty(this,ae,{writable:!0,value:void 0}),Object.defineProperty(this,le,{writable:!0,value:1}),Object.defineProperty(this,ue,{writable:!0,value:void 0}),Object.defineProperty(this,he,{writable:!0,value:void 0}),Object.defineProperty(this,me,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,ye,{writable:!0,value:()=>{if(ee(this,oe)[oe])ee(this,he)[he]=setTimeout(ee(this,ye)[ye],0);else{ee(this,le)[le]=this.limit,this.limit=Math.ceil((ee(this,ue)[ue]+ee(this,le)[le])/2);for(let e=ee(this,le)[le];e<=this.limit;e++)ee(this,pe)[pe]();ee(this,ue)[ue]-ee(this,le)[le]>3?ee(this,he)[he]=setTimeout(ee(this,ye)[ye],2e3):ee(this,le)[le]=Math.floor(ee(this,le)[le]/2)}}}),this.limit="number"!=typeof e||0===e?1/0:e}run(e,t){return!ee(this,oe)[oe]&&ee(this,ne)[ne]<this.limit?ee(this,ce)[ce](e):ee(this,fe)[fe](e,t)}wrapPromiseFunction(e,t){var r=this;return function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];let o;const a=new Promise(((i,s)=>{o=r.run((()=>{let t,r;try{r=Promise.resolve(e(...n))}catch(e){r=Promise.reject(e)}return r.then((e=>{t?s(t):(o.done(),i(e))}),(e=>{t?s(t):(o.done(),s(e))})),e=>{t=function(e){return new Error("Cancelled",{cause:e})}(e)}}),t)}));return a.abort=e=>{o.abort(e)},a.abortOn=ie,a}}resume(){ee(this,oe)[oe]=!1,clearTimeout(ee(this,ae)[ae]);for(let e=0;e<this.limit;e++)ee(this,pe)[pe]()}pause(e){void 0===e&&(e=null),ee(this,oe)[oe]=!0,clearTimeout(ee(this,ae)[ae]),null!=e&&(ee(this,ae)[ae]=setTimeout(ee(this,me)[me],e))}rateLimit(e){clearTimeout(ee(this,he)[he]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(ee(this,ue)[ue]=this.limit-1,this.limit=ee(this,le)[le],ee(this,he)[he]=setTimeout(ee(this,ye)[ye],e))}get isPaused(){return ee(this,oe)[oe]}}function be(e){ee(this,ne)[ne]+=1;let t,r=!1;try{t=e()}catch(e){throw ee(this,ne)[ne]-=1,e}return{abort:e=>{r||(r=!0,ee(this,ne)[ne]-=1,t(e),ee(this,pe)[pe]())},done:()=>{r||(r=!0,ee(this,ne)[ne]-=1,ee(this,pe)[pe]())}}}function we(){queueMicrotask((()=>ee(this,de)[de]()))}function Oe(){if(ee(this,oe)[oe]||ee(this,ne)[ne]>=this.limit)return;if(0===ee(this,se)[se].length)return;const e=ee(this,se)[se].shift(),t=ee(this,ce)[ce](e.fn);e.abort=t.abort,e.done=t.done}function Se(e,t){void 0===t&&(t={});const r={fn:e,priority:t.priority||0,abort:()=>{ee(this,ge)[ge](r)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},i=ee(this,se)[se].findIndex((e=>r.priority>e.priority));return-1===i?ee(this,se)[se].push(r):ee(this,se)[se].splice(i,0,r),r}function Pe(e){const t=ee(this,se)[se].indexOf(e);-1!==t&&ee(this,se)[se].splice(t,1)}const _e=Symbol("__queue");var ke=function(e){return!!e&&(0!==e.readyState&&4!==e.readyState||0===e.status)};var Ue={strings:{uploadStalled:"Upload has not made any progress for %{seconds} seconds. You may want to retry it."}};function Ee(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var xe=0;function je(e){return"__private_"+xe+++"_"+e}function Te(e,t){let r=t;return r||(r=new Error("Upload error")),"string"==typeof r&&(r=new Error(r)),r instanceof Error||(r=Object.assign(new Error("Upload error"),{data:r})),ke(e)?(r=new a(r,e),r):(r.request=e,r)}function Fe(e){return e.data.slice(0,e.data.size,e.meta.type)}var Re=je("queueRequestSocketToken"),Ae=je("upload"),Ce=je("requestSocketToken"),De=je("uploadRemote"),Ie=je("uploadBundle"),Le=je("uploadFiles"),Ne=je("handleUpload");class qe extends n.Z{constructor(e,t){super(e,t),Object.defineProperty(this,Le,{value:Be}),Object.defineProperty(this,Ie,{value:Me}),Object.defineProperty(this,De,{value:ze}),Object.defineProperty(this,Ae,{value:$e}),Object.defineProperty(this,Re,{writable:!0,value:void 0}),Object.defineProperty(this,Ce,{writable:!0,value:async e=>{const t=this.getOptions(e),r=new(e.remote.providerOptions.provider?U:w)(this.uppy,e.remote.providerOptions),i=Array.isArray(t.allowedMetaFields)?t.allowedMetaFields:Object.keys(e.meta);return(await r.post(e.remote.url,{...e.remote.body,protocol:"multipart",endpoint:t.endpoint,size:e.data.size,fieldname:t.fieldName,metadata:Object.fromEntries(i.map((t=>[t,e.meta[t]]))),httpMethod:t.method,useFormData:t.formData,headers:t.headers})).token}}),Object.defineProperty(this,Ne,{writable:!0,value:async e=>{if(0===e.length)return void this.uppy.log("[XHRUpload] No files to upload!");0!==this.opts.limit||this.opts[_e]||this.uppy.log("[XHRUpload] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/xhr-upload/#limit-0","warning"),this.uppy.log("[XHRUpload] Uploading...");const t=function(e){return e.filter((e=>!(e=>"error"in e&&e.error)(e)))}(this.uppy.getFilesByIds(e)),r=function(e){return e.filter((e=>!e.progress.uploadStarted||!e.isRestored))}(t);if(this.uppy.emit("upload-start",r),this.opts.bundle){if(t.some((e=>e.isRemote)))throw new Error("Cant upload remote files when the `bundle: true` option is set");if("function"==typeof this.opts.headers)throw new TypeError("`headers` may not be a function when the `bundle: true` option is set");await Ee(this,Ie)[Ie](t)}else await Ee(this,Le)[Le](t)}}),this.type="uploader",this.id=this.opts.id||"XHRUpload",this.title="XHRUpload",this.defaultLocale=Ue;const r={formData:!0,fieldName:t.bundle?"files[]":"file",method:"post",allowedMetaFields:null,responseUrlFieldName:"url",bundle:!1,headers:{},timeout:3e4,limit:5,withCredentials:!1,responseType:"",getResponseData(t){let r={};try{r=JSON.parse(t)}catch(t){e.log(t)}return r},getResponseError(e,t){let r=new Error("Upload error");return ke(t)&&(r=new a(r,t)),r},validateStatus(e){return e>=200&&e<300}};if(this.opts={...r,...t},this.i18nInit(),_e in this.opts?this.requests=this.opts[_e]:this.requests=new ve(this.opts.limit),this.opts.bundle&&!this.opts.formData)throw new Error("`opts.formData` must be true when `opts.bundle` is enabled.");if(void 0===(null==t?void 0:t.allowedMetaFields)&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");this.uploaderEvents=Object.create(null),Ee(this,Re)[Re]=this.requests.wrapPromiseFunction(Ee(this,Ce)[Ce],{priority:-1})}getOptions(e){const t=this.uppy.getState().xhrUpload,{headers:r}=this.opts,i={...this.opts,...t||{},...e.xhrUpload||{},headers:{}};return"function"==typeof r?i.headers=r(e):Object.assign(i.headers,this.opts.headers),t&&Object.assign(i.headers,t.headers),e.xhrUpload&&Object.assign(i.headers,e.xhrUpload.headers),i}addMetadata(e,t,r){(Array.isArray(r.allowedMetaFields)?r.allowedMetaFields:Object.keys(t)).forEach((r=>{e.append(r,t[r])}))}createFormDataUpload(e,t){const r=new FormData;this.addMetadata(r,e.meta,t);const i=Fe(e);return e.name?r.append(t.fieldName,i,e.meta.name):r.append(t.fieldName,i),r}createBundledUpload(e,t){const r=new FormData,{meta:i}=this.uppy.getState();return this.addMetadata(r,i,t),e.forEach((e=>{const t=this.getOptions(e),i=Fe(e);e.name?r.append(t.fieldName,i,e.name):r.append(t.fieldName,i)})),r}async connectToServerSocket(e){return new Promise(((t,r)=>{const i=this.getOptions(e),n=e.serverToken,s=function(e){const t=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i.exec(e)[1];return`${/^http:\/\//i.test(e)?"ws":"wss"}://${t}`}(e.remote.companionUrl);let o;const a=()=>{null==o&&(o=new N({target:`${s}/api/${n}`}),o.on("progress",(t=>q(this,t,e))),o.on("success",(r=>{const n=i.getResponseData(r.response.responseText,r.response),s=n[i.responseUrlFieldName],a={status:r.response.status,body:n,uploadURL:s};return this.uppy.emit("upload-success",e,a),l.done(),o.close(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null),t()})),o.on("error",(t=>{const n=t.response,s=n?i.getResponseError(n.responseText,n):Object.assign(new Error(t.error.message),{cause:t.error});this.uppy.emit("upload-error",e,s),l.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null),r(s)})))};this.uploaderEvents[e.id]=new V(this.uppy);let l=this.requests.run((()=>{var t;e.isPaused?null==(t=o)||t.send("pause",{}):a();return()=>o.close()}));this.onFileRemove(e.id,(()=>{var r;null==(r=o)||r.send("cancel",{}),l.abort(),t(`upload ${e.id} was removed`)})),this.onCancelAll(e.id,(function(r){let{reason:i}=void 0===r?{}:r;var n;"user"===i&&(null==(n=o)||n.send("cancel",{}),l.abort());t(`upload ${e.id} was canceled`)}));const u=()=>{null==o?l.abort():(o.send("pause",{}),l.done()),l=this.requests.run((()=>(e.isPaused||(null==o?a():o.send("resume",{})),()=>o.close())))};this.onRetry(e.id,u),this.onRetryAll(e.id,u)})).catch((t=>(this.uppy.emit("upload-error",e,t),Promise.reject(t))))}onFileRemove(e,t){this.uploaderEvents[e].on("file-removed",(r=>{e===r.id&&t(r.id)}))}onRetry(e,t){this.uploaderEvents[e].on("upload-retry",(r=>{e===r&&t()}))}onRetryAll(e,t){this.uploaderEvents[e].on("retry-all",(()=>{this.uppy.getFile(e)&&t()}))}onCancelAll(e,t){var r=this;this.uploaderEvents[e].on("cancel-all",(function(){r.uppy.getFile(e)&&t(...arguments)}))}install(){if(this.opts.bundle){const{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!1}})}this.uppy.addUploader(Ee(this,Ne)[Ne])}uninstall(){if(this.opts.bundle){const{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!0}})}this.uppy.removeUploader(Ee(this,Ne)[Ne])}}async function $e(e,t,r){const i=this.getOptions(e);return this.uppy.log(`uploading ${t} of ${r}`),new Promise(((t,r)=>{const n=i.formData?this.createFormDataUpload(e,i):e.data,o=new XMLHttpRequest;let a;this.uploaderEvents[e.id]=new V(this.uppy);const l=new Q(i.timeout,(()=>{const t=new Error(this.i18n("uploadStalled",{seconds:Math.ceil(i.timeout/1e3)}));this.uppy.emit("upload-stalled",t,[e])})),u=(0,s.x)();o.upload.addEventListener("loadstart",(()=>{this.uppy.log(`[XHRUpload] ${u} started`)})),o.upload.addEventListener("progress",(t=>{this.uppy.log(`[XHRUpload] ${u} progress: ${t.loaded} / ${t.total}`),l.progress(),t.lengthComputable&&this.uppy.emit("upload-progress",e,{uploader:this,bytesUploaded:t.loaded,bytesTotal:t.total})})),o.addEventListener("load",(()=>{if(this.uppy.log(`[XHRUpload] ${u} finished`),l.done(),a.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null),i.validateStatus(o.status,o.responseText,o)){const r=i.getResponseData(o.responseText,o),n=r[i.responseUrlFieldName],s={status:o.status,body:r,uploadURL:n};return this.uppy.emit("upload-success",e,s),n&&this.uppy.log(`Download ${e.name} from ${n}`),t(e)}const n=i.getResponseData(o.responseText,o),s=Te(o,i.getResponseError(o.responseText,o)),h={status:o.status,body:n};return this.uppy.emit("upload-error",e,s,h),r(s)})),o.addEventListener("error",(()=>{this.uppy.log(`[XHRUpload] ${u} errored`),l.done(),a.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null);const t=Te(o,i.getResponseError(o.responseText,o));return this.uppy.emit("upload-error",e,t),r(t)})),o.open(i.method.toUpperCase(),i.endpoint,!0),o.withCredentials=i.withCredentials,""!==i.responseType&&(o.responseType=i.responseType),a=this.requests.run((()=>{const t=this.getOptions(e);return Object.keys(t.headers).forEach((e=>{o.setRequestHeader(e,t.headers[e])})),o.send(n),()=>{l.done(),o.abort()}})),this.onFileRemove(e.id,(()=>{a.abort(),r(new Error("File removed"))})),this.onCancelAll(e.id,(e=>{let{reason:t}=e;"user"===t&&a.abort(),r(new Error("Upload cancelled"))}))}))}async function ze(e){try{if(e.serverToken)return await this.connectToServerSocket(e);const t=await Ee(this,Re)[Re](e);if(!this.uppy.getState().files[e.id])return;return this.uppy.setFileState(e.id,{serverToken:t}),await this.connectToServerSocket(this.uppy.getFile(e.id))}catch(t){throw this.uppy.setFileState(e.id,{serverToken:void 0}),this.uppy.emit("upload-error",e,t),t}}function Me(e){return new Promise(((t,r)=>{const{endpoint:i}=this.opts,{method:n}=this.opts,s=this.uppy.getState().xhrUpload,o=this.createBundledUpload(e,{...this.opts,...s||{}}),a=new XMLHttpRequest,l=t=>{e.forEach((e=>{this.uppy.emit("upload-error",e,t)}))},u=new Q(this.opts.timeout,(()=>{const t=new Error(this.i18n("uploadStalled",{seconds:Math.ceil(this.opts.timeout/1e3)}));this.uppy.emit("upload-stalled",t,e)}));a.upload.addEventListener("loadstart",(()=>{this.uppy.log("[XHRUpload] started uploading bundle"),u.progress()})),a.upload.addEventListener("progress",(t=>{u.progress(),t.lengthComputable&&e.forEach((e=>{this.uppy.emit("upload-progress",e,{uploader:this,bytesUploaded:t.loaded/t.total*e.size,bytesTotal:e.size})}))})),a.addEventListener("load",(i=>{if(u.done(),this.opts.validateStatus(i.target.status,a.responseText,a)){const r=this.opts.getResponseData(a.responseText,a),n={status:i.target.status,body:r};return e.forEach((e=>{this.uppy.emit("upload-success",e,n)})),t()}const n=this.opts.getResponseError(a.responseText,a)||new Error("Upload error");return n.request=a,l(n),r(n)})),a.addEventListener("error",(()=>{u.done();const e=this.opts.getResponseError(a.responseText,a)||new Error("Upload error");return l(e),r(e)})),this.uppy.on("cancel-all",(function(e){let{reason:t}=void 0===e?{}:e;"user"===t&&(u.done(),a.abort())})),a.open(n.toUpperCase(),i,!0),a.withCredentials=this.opts.withCredentials,""!==this.opts.responseType&&(a.responseType=this.opts.responseType),Object.keys(this.opts.headers).forEach((e=>{a.setRequestHeader(e,this.opts.headers[e])})),a.send(o)}))}async function Be(e){await Promise.allSettled(e.map(((t,r)=>{const i=parseInt(r,10)+1,n=e.length;return t.isRemote?Ee(this,De)[De](t,i,n):Ee(this,Ae)[Ae](t,i,n)})))}qe.VERSION="3.2.0"},9022:function(e,t,r){"use strict";r.d(t,{x:function(){return i}});let i=(e=21)=>{let t="",r=e;for(;r--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t}}},function(e){var t;t=7647,e(e.s=t)}]);